
PLAY [primary_db_build] ********************************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.16.29]

TASK [pri_db_build : get the primary vm_cluster_ocid from the cluster display name lifecycle_state=AVAILABLE, compartment_id={{ pri_compartment_id }}, display_name={{ pri_vm_cluster_display_name }}, region={{ pri_region }}] ***
ok: [10.100.16.29]

TASK [pri_db_build : display pri_cluster_out var=pri_cluster_out.cloud_vm_clusters[0].id] ***
ok: [10.100.16.29] => {
    "pri_cluster_out.cloud_vm_clusters[0].id": "ocid1.cloudvmcluster.oc1.uk-london-1.anwgiljtpgtet6qa6ijohnizej4w2sk3gw7cohbeolvm7uc225shoycsjdzq"
}

TASK [pri_db_build : set the vm cluster id pri_vm_cluster_id={{ pri_cluster_out.cloud_vm_clusters[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_db_build : get the primary db_home_id vm_cluster_id={{ pri_vm_cluster_id }}, compartment_id={{ pri_compartment_id }}, lifecycle_state=AVAILABLE, display_name={{ pri_db_home_display_name }}, region={{ pri_region }}] ***
ok: [10.100.16.29]

TASK [pri_db_build : display pri_db_home_out var=pri_db_home_out.db_homes[0].id] ***
ok: [10.100.16.29] => {
    "pri_db_home_out.db_homes[0].id": "ocid1.dbhome.oc1.uk-london-1.anwgiljtwli4jtqalrdls4sl5w4p4fnkjeszey2ijjdxjpqlmthocb44llia"
}

TASK [pri_db_build : set the db_home_id pri_db_home_id={{ pri_db_home_out.db_homes[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_db_build : build primary database compartment_id={{ pri_compartment_id }}, db_home_id={{ pri_db_home_id }}, region={{ pri_region }}, wait=True, wait_timeout=14400, database={'admin_password': '{{ admin_password }}', 'db_name': '{{ db_name }}', 'db_unique_name': '{{ pri_db_unique_name }}', 'pdb_name': '{{ pdb_name }}', 'character_set': '{{ character_set }}', 'ncharacter_set': '{{ ncharacter_set }}', 'db_workload': '{{ db_workload }}'}] ***
changed: [10.100.16.29]

TASK [pri_db_build : display pri_out var=pri_out.database] *********************
ok: [10.100.16.29] => {
    "pri_out.database": {
        "character_set": "AL32UTF8",
        "compartment_id": "ocid1.compartment.oc1..aaaaaaaalj2ziyzctjkbhcdszxnkhvf3ijaagfwzmrf7ffi5hvwejazyr2wq",
        "connection_strings": {
            "all_connection_strings": {
                "cdbDefault": "foaukl1pddb-4kxck-scan.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com:1521/OTCHPDUS_UKL.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com",
                "cdbIpDefault": "(DESCRIPTION=(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(LOAD_BALANCE=on)(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.57)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.19)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.56)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=OTCHPDUS_UKL.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com)))"
            },
            "cdb_default": "foaukl1pddb-4kxck-scan.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com:1521/OTCHPDUS_UKL.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com",
            "cdb_ip_default": "(DESCRIPTION=(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(LOAD_BALANCE=on)(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.57)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.19)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.56)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=OTCHPDUS_UKL.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com)))"
        },
        "database_management_config": null,
        "database_software_image_id": "ocid1.databasesoftwareimage.oc1.uk-london-1.anwgiljtpgtet6qayey5rkocdwcu6kujvauqsboemjk6d7njvye25vzuirva",
        "db_backup_config": null,
        "db_home_id": "ocid1.dbhome.oc1.uk-london-1.anwgiljtwli4jtqalrdls4sl5w4p4fnkjeszey2ijjdxjpqlmthocb44llia",
        "db_name": "OTCHPDUS",
        "db_system_id": null,
        "db_unique_name": "OTCHPDUS_UKL",
        "db_workload": "OLTP",
        "defined_tags": {
            "Hays-Tags": {
                "AppName": "OneTouch Exa Prod",
                "AppOwner": "Front Office",
                "BillableTo": "UK ITPS",
                "Environment": "Prod",
                "TechnicalOwner": "Front Office"
            },
            "Oracle-Tags": {
                "CreatedBy": "default/ansibleadmin",
                "CreatedOn": "2024-12-06T16:27:31.160Z"
            }
        },
        "freeform_tags": {},
        "id": "ocid1.database.oc1.uk-london-1.anwgiljtpgtet6qa747mfh66c7q3ch7fki3tih467ncgq3id33j4azelytxq",
        "is_cdb": null,
        "key_store_id": null,
        "key_store_wallet_name": null,
        "kms_key_id": null,
        "kms_key_version_id": null,
        "last_backup_duration_in_seconds": null,
        "last_backup_timestamp": null,
        "last_failed_backup_timestamp": null,
        "lifecycle_details": null,
        "lifecycle_state": "AVAILABLE",
        "ncharacter_set": "UTF8",
        "pdb_name": "USPD",
        "sid_prefix": "OTCHPDUS",
        "source_database_point_in_time_recovery_timestamp": null,
        "time_created": "2024-12-06T16:27:31.190000+00:00",
        "vault_id": null,
        "vm_cluster_id": "ocid1.cloudvmcluster.oc1.uk-london-1.anwgiljtpgtet6qa6ijohnizej4w2sk3gw7cohbeolvm7uc225shoycsjdzq"
    }
}

PLAY [change db_domain parameter] **********************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.15]

TASK [pri_change_db_domain : change the db_domain parameter to hays domain name _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET db_domain='{{ hays_domain_name }}' scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15]

TASK [pri_change_db_domain : display domain_out var=domain_out.stdout_lines] ***
ok: [10.100.36.15] => {
    "domain_out.stdout_lines": []
}

TASK [pri_change_db_domain : restart the database _raw_params=.  "/home/oracle/{{db_name}}.env"
{{pri_oracle_home}}/bin/srvctl stop database -db {{pri_db_unique_name}}
{{pri_oracle_home}}/bin/srvctl start database -db {{pri_db_unique_name}}
{{pri_oracle_home}}/bin/srvctl status database -db {{pri_db_unique_name}}
] ***
changed: [10.100.36.15]

TASK [pri_change_db_domain : display the db_status_out var=db_status_out.stdout_lines] ***
ok: [10.100.36.15] => {
    "db_status_out.stdout_lines": [
        "Instance OTCHPDUS1 is running on node foaukl1pddb-4kxck1",
        "Instance OTCHPDUS2 is running on node foaukl1pddb-4kxck2"
    ]
}

TASK [pri_change_db_domain : verify the db_domain is set _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n  show parameter db_domain" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15]

TASK [pri_change_db_domain : display db_domain_out var=db_domain_out.stdout_lines] ***
ok: [10.100.36.15] => {
    "db_domain_out.stdout_lines": [
        "db_domain\t\t\t     string\t emea.hays.loc"
    ]
}

TASK [pri_change_db_domain : fail msg=DB domain is not set to {{ hays_domain_name }}] ***
skipping: [10.100.36.15]

PLAY [update the tnsnames.ora & sqlnet.ora files] ******************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.33]
ok: [10.100.36.15]

TASK [tns_update : Get current timestamp _raw_params=date +%Y%m%d%H%M%S] *******
changed: [10.100.36.15]
changed: [10.100.36.33]

TASK [tns_update : take a backup of the existing tnsnames.ora file _raw_params=mv "{{ pri_tns_admin }}/tnsnames.ora" "{{ pri_tns_admin }}/tnsnames.ora_{{timestamp.stdout}}.bak"] ***
changed: [10.100.36.33]
changed: [10.100.36.15]

TASK [tns_update : display the tns_backup status msg={{ tns_backup }}] *********
ok: [10.100.36.15] => {
    "msg": {
        "changed": true,
        "cmd": [
            "mv",
            "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora",
            "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora_20241206165649.bak"
        ],
        "delta": "0:00:00.006247",
        "end": "2024-12-06 16:56:50.397345",
        "failed": false,
        "rc": 0,
        "start": "2024-12-06 16:56:50.391098",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
ok: [10.100.36.33] => {
    "msg": {
        "changed": true,
        "cmd": [
            "mv",
            "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora",
            "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora_20241206165649.bak"
        ],
        "delta": "0:00:00.003496",
        "end": "2024-12-06 16:56:50.301429",
        "failed": false,
        "rc": 0,
        "start": "2024-12-06 16:56:50.297933",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}

TASK [tns_update : create the new tns_names.ora file from the template for OTCHPDUS src={{ item.src }}, dest={{ item.dest }}, owner=oracle, group=oinstall, mode=u=rw,g=r] ***
changed: [10.100.36.33] => (item={'src': 'tnsnames.ora.j2', 'dest': '/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora'})
changed: [10.100.36.15] => (item={'src': 'tnsnames.ora.j2', 'dest': '/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora'})

TASK [tns_update : display the new tnsnames.ora file status msg={{ tnsfile_out }}] ***
ok: [10.100.36.15] => {
    "msg": {
        "changed": true,
        "msg": "All items completed",
        "results": [
            {
                "ansible_loop_var": "item",
                "changed": true,
                "checksum": "997f6eac83b7f3109682a2aa8a92457f1c5e185b",
                "dest": "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora",
                "diff": [],
                "failed": false,
                "gid": 1001,
                "group": "oinstall",
                "invocation": {
                    "module_args": {
                        "_original_basename": "tnsnames.ora.j2",
                        "attributes": null,
                        "backup": false,
                        "checksum": "997f6eac83b7f3109682a2aa8a92457f1c5e185b",
                        "content": null,
                        "delimiter": null,
                        "dest": "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora",
                        "directory_mode": null,
                        "follow": false,
                        "force": true,
                        "group": "oinstall",
                        "local_follow": null,
                        "mode": "u=rw,g=r",
                        "owner": "oracle",
                        "regexp": null,
                        "remote_src": null,
                        "selevel": null,
                        "serole": null,
                        "setype": null,
                        "seuser": null,
                        "src": "/var/tmp/ansible-tmp-1733504210.955932-882813-225427356421982/source",
                        "unsafe_writes": false,
                        "validate": null
                    }
                },
                "item": {
                    "dest": "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora",
                    "src": "tnsnames.ora.j2"
                },
                "md5sum": "908d4098e851ed36d0e4c4525fb15ba5",
                "mode": "0644",
                "owner": "oracle",
                "size": 1186,
                "src": "/var/tmp/ansible-tmp-1733504210.955932-882813-225427356421982/source",
                "state": "file",
                "uid": 1001
            }
        ]
    }
}
ok: [10.100.36.33] => {
    "msg": {
        "changed": true,
        "msg": "All items completed",
        "results": [
            {
                "ansible_loop_var": "item",
                "changed": true,
                "checksum": "997f6eac83b7f3109682a2aa8a92457f1c5e185b",
                "dest": "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora",
                "diff": [],
                "failed": false,
                "gid": 1001,
                "group": "oinstall",
                "invocation": {
                    "module_args": {
                        "_original_basename": "tnsnames.ora.j2",
                        "attributes": null,
                        "backup": false,
                        "checksum": "997f6eac83b7f3109682a2aa8a92457f1c5e185b",
                        "content": null,
                        "delimiter": null,
                        "dest": "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora",
                        "directory_mode": null,
                        "follow": false,
                        "force": true,
                        "group": "oinstall",
                        "local_follow": null,
                        "mode": "u=rw,g=r",
                        "owner": "oracle",
                        "regexp": null,
                        "remote_src": null,
                        "selevel": null,
                        "serole": null,
                        "setype": null,
                        "seuser": null,
                        "src": "/var/tmp/ansible-tmp-1733504210.889192-882815-133195928216105/source",
                        "unsafe_writes": false,
                        "validate": null
                    }
                },
                "item": {
                    "dest": "/u02/app/oracle/product/19.0.0.0/dbhome_2/network/admin/OTCHPDUS/tnsnames.ora",
                    "src": "tnsnames.ora.j2"
                },
                "md5sum": "908d4098e851ed36d0e4c4525fb15ba5",
                "mode": "0644",
                "owner": "oracle",
                "size": 1186,
                "src": "/var/tmp/ansible-tmp-1733504210.889192-882815-133195928216105/source",
                "state": "file",
                "uid": 1001
            }
        ]
    }
}

TASK [tns_update : check tns entries already exists for OTCHPDUS in tnsnames.ora file paths={{ pri_tns_admin }}, patterns=tnsnames.ora, contains=# Ansible managed tns entries for {{ db_name }}] ***
ok: [10.100.36.33]
ok: [10.100.36.15]

TASK [tns_update : out tns_out variable var=tns_out] ***************************
ok: [10.100.36.15] => {
    "tns_out": {
        "changed": false,
        "examined": 4,
        "failed": false,
        "files": [],
        "matched": 0,
        "msg": ""
    }
}
ok: [10.100.36.33] => {
    "tns_out": {
        "changed": false,
        "examined": 4,
        "failed": false,
        "files": [],
        "matched": 0,
        "msg": ""
    }
}

TASK [tns_update : Add the required TNS entries to tnsnames.ora path={{ pri_tns_admin }}/tnsnames.ora, block={% for entry in tns_entries %}
{{ entry.name }} =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = {{ entry.host }})(PORT = {{ entry.port }}))
    (CONNECT_DATA =
      (SERVER = {{ entry.server }})
      (SERVICE_NAME = {{ entry.service }})
    )
  )
{% endfor %}
, marker=# Ansible managed tns entries for {{ db_name }}] ***
changed: [10.100.36.15]
changed: [10.100.36.33]

TASK [tns_update : check if ansible managed  sqlnet parameters already exists for OTCHPDUS in sqlnet.ora file paths={{ pri_tns_admin }}, patterns=sqlnet.ora, contains=# Ansible managed sqlnet parameters for {{ db_name }}] ***
ok: [10.100.36.33]
ok: [10.100.36.15]

TASK [tns_update : add a comment  for ansible managed parameters path={{ pri_tns_admin }}/sqlnet.ora, line=# Ansible managed sqlnet parameters for {{db_name}}, insertafter=EOF] ***
changed: [10.100.36.33]
changed: [10.100.36.15]

TASK [tns_update : append the sqlnet.ora file to add SQLNET.ALLOWED_LOGON_VERSION_SERVER path={{ pri_tns_admin }}/sqlnet.ora, line=SQLNET.ALLOWED_LOGON_VERSION_SERVER={{sqlnet_allowed_version}}, insertafter=EOF] ***
changed: [10.100.36.15]
changed: [10.100.36.33]

PLAY [do the post_db_build tasks] **********************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.15]

TASK [post_db_build : check if block change tracking has been enabled _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n select status from v\$block_change_tracking;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : enable block change tracking if it's not enabled _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter database enable block change tracking;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : check BCT status _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n select status from v\$block_change_tracking;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : dispplay the BCT status var=bct_out.stdout_lines] ********
ok: [10.100.36.15] => {
    "bct_out.stdout_lines": [
        "ENABLED"
    ]
}

TASK [post_db_build : update the cdb level database parameters to match the source _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set cursor_sharing='{{cursor_sharing}}' scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set nls_language='{{nls_language}}'  scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set nls_territory='{{nls_territoty}}'  scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba   
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set pga_aggregate_target={{pga_aggregate_target}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set processes={{processes}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set sessions={{sessions}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set sga_max_size={{sga_max_size}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set sga_target={{sga_target}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set db_recovery_file_dest_size={{db_recovery_file_dest_size}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set target_pdbs={{target_pdbs}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET ARCHIVE_LAG_TARGET ={{archive_lag_target}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET parallel_max_servers ={{parallel_max_servers}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET open_cursors={{open_cursors}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET optimizer_index_caching={{optimizer_index_caching}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET optimizer_index_cost_adj={{optimizer_index_cost_adj}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET container_data={{container_data}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : update the pdb level database parameters to match the source _raw_params=.  "/home/oracle/{{db_name}}.env" 
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set nls_language='{{nls_language}}'  scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set nls_territory='{{nls_territoty}}'  scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set nls_iso_currency='{{nls_iso_currency}}'  scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set sga_target={{sga_target}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set parallel_max_servers ={{parallel_max_servers}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set open_cursors={{open_cursors}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET optimizer_index_caching={{optimizer_index_caching}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET optimizer_index_cost_adj={{optimizer_index_cost_adj}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n ALTER SYSTEM SET container_data={{container_data}} scope=spfile sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : restart the database _raw_params=.  "/home/oracle/{{db_name}}.env"
{{pri_oracle_home}}/bin/srvctl stop database -db {{pri_db_unique_name}}
{{pri_oracle_home}}/bin/srvctl start database -db {{pri_db_unique_name}}
{{pri_oracle_home}}/bin/srvctl status database -db {{pri_db_unique_name}}
] ***
changed: [10.100.36.15]

TASK [post_db_build : display the db_status_out var=db_status_out.stdout_lines] ***
ok: [10.100.36.15] => {
    "db_status_out.stdout_lines": [
        "Instance OTCHPDUS1 is running on node foaukl1pddb-4kxck1",
        "Instance OTCHPDUS2 is running on node foaukl1pddb-4kxck2"
    ]
}

TASK [post_db_build : check the db_parameters at the cdb level _raw_params=.  "/home/oracle/{{db_name}}.env" 
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n SELECT name, value FROM v\$parameter WHERE name IN ('cursor_sharing','pga_aggregate_limit', 'pga_aggregate_target', 'processes', 'sessions', 'sga_max_size', 'sga_target', 'db_recovery_file_dest_size', 'target_pdbs', 'parallel_max_servers', 'open_cursors', 'optimizer_index_caching', 'optimizer_index_cost_adj','container_data') order by name;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n SELECT parameter, value FROM nls_instance_parameters WHERE parameter in ('NLS_LANGUAGE', 'NLS_TERRITORY', 'NLS_ISO_CURRENCY' );" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : display the cdb parameters var=cdb_out.stdout_lines] *****
ok: [10.100.36.15] => {
    "cdb_out.stdout_lines": [
        "container_data",
        "CURRENT_DICTIONARY",
        "",
        "cursor_sharing",
        "FORCE",
        "",
        "db_recovery_file_dest_size",
        "536870912000",
        "",
        "open_cursors",
        "2000",
        "",
        "optimizer_index_caching",
        "90",
        "",
        "optimizer_index_cost_adj",
        "10",
        "",
        "parallel_max_servers",
        "773",
        "",
        "pga_aggregate_limit",
        "6442450944",
        "",
        "pga_aggregate_target",
        "3221225472",
        "",
        "processes",
        "1000",
        "",
        "sessions",
        "1536",
        "",
        "sga_max_size",
        "12884901888",
        "",
        "sga_target",
        "12884901888",
        "",
        "target_pdbs",
        "3",
        "",
        "NLS_LANGUAGE",
        "ENGLISH",
        "",
        "NLS_TERRITORY",
        "UNITED KINGDOM",
        "",
        "NLS_ISO_CURRENCY"
    ]
}

TASK [post_db_build : check the db_parameters at the pdb level _raw_params=.  "/home/oracle/{{db_name}}.env" 
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n SELECT name, value FROM v\$parameter WHERE name IN ('cursor_sharing','pga_aggregate_limit', 'pga_aggregate_target', 'processes', 'sessions', 'sga_max_size', 'sga_target', 'db_recovery_file_dest_size', 'target_pdbs', 'parallel_max_servers', 'open_cursors', 'optimizer_index_caching', 'optimizer_index_cost_adj','container_data') order by name;" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n SELECT parameter, value FROM nls_instance_parameters WHERE parameter in ('NLS_LANGUAGE', 'NLS_TERRITORY', 'NLS_ISO_CURRENCY' );" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : display the pdb parameters var=pdb_out.stdout_lines] *****
ok: [10.100.36.15] => {
    "pdb_out.stdout_lines": [
        "container_data",
        "CURRENT_DICTIONARY",
        "",
        "cursor_sharing",
        "FORCE",
        "",
        "db_recovery_file_dest_size",
        "536870912000",
        "",
        "open_cursors",
        "2000",
        "",
        "optimizer_index_caching",
        "90",
        "",
        "optimizer_index_cost_adj",
        "10",
        "",
        "parallel_max_servers",
        "773",
        "",
        "pga_aggregate_limit",
        "6442450944",
        "",
        "pga_aggregate_target",
        "3221225472",
        "",
        "processes",
        "1000",
        "",
        "sessions",
        "1536",
        "",
        "sga_max_size",
        "12884901888",
        "",
        "sga_target",
        "12884901888",
        "",
        "target_pdbs",
        "3",
        "",
        "NLS_LANGUAGE",
        "ENGLISH",
        "",
        "NLS_TERRITORY",
        "UNITED KINGDOM",
        "",
        "NLS_ISO_CURRENCY",
        "UNITED KINGDOM"
    ]
}

TASK [post_db_build : change the segment policy to AUTO for  AUD$ & FGA_LOG$ in the pdb level _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING ON ECHO OFF\n  EXEC DBMS_AUDIT_MGMT.set_audit_trail_location (audit_trail_type => DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD, audit_trail_location_value => 'SYSAUX');" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING ON ECHO OFF\n  EXEC DBMS_AUDIT_MGMT.set_audit_trail_location (audit_trail_type => DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD, audit_trail_location_value => 'SYSAUX');" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba 
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n select t.table_name,ts.segment_space_management from dba_tables t, dba_tablespaces ts where ts.tablespace_name = t.tablespace_name and t.table_name in ('AUD\$','FGA_LOG\$');" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : display the segment policy for AUD$ & FGA_LOG$ in the pdb level now. var=seg_out.stdout_lines] ***
ok: [10.100.36.15] => {
    "seg_out.stdout_lines": [
        "",
        "PL/SQL procedure successfully completed.",
        "",
        "",
        "PL/SQL procedure successfully completed.",
        "",
        "AUD$",
        "AUTO",
        "",
        "FGA_LOG$",
        "AUTO"
    ]
}

TASK [post_db_build : do the global_names changes on CDB _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set global_names=false scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter database rename global_name to {{db_name}};" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : do the global_names changes on PDB _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter pluggable database {{pdb_name}} close instances=ALL;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter pluggable database {{pdb_name}} open restricted instances=ALL;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter session set container={{pdb_name}}; alter pluggable database rename global_name to {{pdb_name}} instances=ALL;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter pluggable database {{pdb_name}} close instances=ALL;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter pluggable database {{pdb_name}} open instances=ALL;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : restart the database _raw_params=.  "/home/oracle/{{db_name}}.env"
{{pri_oracle_home}}/bin/srvctl stop database -db {{pri_db_unique_name}}
{{pri_oracle_home}}/bin/srvctl start database -db {{pri_db_unique_name}}
{{pri_oracle_home}}/bin/srvctl status database -db {{pri_db_unique_name}}
] ***
changed: [10.100.36.15]

TASK [post_db_build : display the db_status_out var=db_status_out.stdout_lines] ***
ok: [10.100.36.15] => {
    "db_status_out.stdout_lines": [
        "Instance OTCHPDUS1 is running on node foaukl1pddb-4kxck1",
        "Instance OTCHPDUS2 is running on node foaukl1pddb-4kxck2"
    ]
}

TASK [post_db_build : check the global_names parameter in cdb and pdb level _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n show parameter global_names" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n show parameter global_names" | {{ pri_oracle_home }}/bin/sqlplus -s sys/{{admin_password}}@{{db_name}}_{{pdb_name}} as sysdba
] ***
changed: [10.100.36.15]

TASK [post_db_build : display global_names parameter value in CDB and PDB var=global_out.stdout_lines] ***
ok: [10.100.36.15] => {
    "global_out.stdout_lines": [
        "global_names\t\t\t     boolean",
        "FALSE",
        "global_names\t\t\t     boolean",
        "FALSE"
    ]
}

PLAY [do the redo resize] ******************************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.15]

TASK [redo_update : resize the redo logs and groups --precheck _raw_params=/usr/bin/dbaascli database update --dbname {{db_name}} --redosize {{redo_size}} --groups {{redo_groups}} --precheck
] ***
changed: [10.100.36.15]

TASK [redo_update : display precheck_out var=precheck_out.stdout_lines] ********
ok: [10.100.36.15] => {
    "precheck_out.stdout_lines": [
        "DBAAS CLI version 24.4.1.0.0",
        "Executing command database update --dbname OTCHPDUS --redosize 1024M --groups 4 --precheck",
        "INFO: Update log - /var/opt/oracle/log/OTCHPDUS/update/update_2024-12-06_17:01:19.621430340321.log",
        "INFO : Running Pre-Checks",
        "INFO : Precheck completed"
    ]
}

TASK [redo_update : resize the redo logs and groups if the precheck is successfully completed _raw_params=/usr/bin/dbaascli database update --dbname {{db_name}} --redosize {{redo_size}} --groups {{redo_groups}} 
] ***
changed: [10.100.36.15]

TASK [redo_update : display the redo_out var=redo_out.stdout_lines] ************
ok: [10.100.36.15] => {
    "redo_out.stdout_lines": [
        "DBAAS CLI version 24.4.1.0.0",
        "Executing command database update --dbname OTCHPDUS --redosize 1024M --groups 4",
        "INFO: Update log - /var/opt/oracle/log/OTCHPDUS/update/update_2024-12-06_17:01:29.234474341693.log",
        "INFO : Running Pre-Checks",
        "INFO : Resizing online redolog, this might take some time , please a take look at log /var/opt/oracle/log/OTCHPDUS/update/update_2024-12-06_17:01:29.234474341693.log",
        "INFO : Completed online redolog resize"
    ]
}

PLAY [create service] **********************************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.15]

TASK [create_service : Create database service/s _raw_params=.  "/home/oracle/{{db_name}}.env"
{{pri_oracle_home}}/bin/srvctl add service -db "{{ item.db_unique_name }}" -service "{{ item.service_name }}" -preferred "{{ item.preferred_instances | join(',') }}" -tafpolicy "{{ item.taf_policy }}" -policy "{{ item.policy }}" -failovertype "{{ item.failover_type }}" -failovermethod "{{ item.failover_method }}" -failoverretry "{{ item.failover_retry }}" -pdb "{{ item.pdb_name }}"
] ***
changed: [10.100.36.15] => (item={'service_name': 'VEREDUSPROD_SERVICE', 'db_unique_name': 'OTCHPDUS_UKL', 'preferred_instances': ['OTCHPDUS1', 'OTCHPDUS2'], 'taf_policy': 'BASIC', 'policy': 'AUTOMATIC', 'failover_type': 'SELECT', 'failover_method': 'BASIC', 'failover_retry': 30, 'pdb_name': 'USPD'})

TASK [create_service : Start services _raw_params=.  "/home/oracle/{{db_name}}.env"
srvctl start service -db "{{ item.item.db_unique_name }}" -service "{{ item.item.service_name }}" 
] ***
changed: [10.100.36.15] => (item={'cmd': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', 'stdout': '', 'stderr': '', 'rc': 0, 'start': '2024-12-06 17:02:21.251241', 'end': '2024-12-06 17:02:22.309288', 'delta': '0:00:01.058047', 'changed': True, 'invocation': {'module_args': {'_raw_params': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', '_uses_shell': True, 'warn': True, 'stdin_add_newline': True, 'strip_empty_ends': True, 'argv': None, 'chdir': None, 'executable': None, 'creates': None, 'removes': None, 'stdin': None}}, 'stdout_lines': [], 'stderr_lines': [], 'failed': False, 'item': {'service_name': 'VEREDUSPROD_SERVICE', 'db_unique_name': 'OTCHPDUS_UKL', 'preferred_instances': ['OTCHPDUS1', 'OTCHPDUS2'], 'taf_policy': 'BASIC', 'policy': 'AUTOMATIC', 'failover_type': 'SELECT', 'failover_method': 'BASIC', 'failover_retry': 30, 'pdb_name': 'USPD'}, 'ansible_loop_var': 'item'})

TASK [create_service : Check service status _raw_params=.  "/home/oracle/{{db_name}}.env"
srvctl status service -db "{{ item.item.db_unique_name }}" -service "{{ item.item.service_name }}" 
] ***
changed: [10.100.36.15] => (item={'cmd': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', 'stdout': '', 'stderr': '', 'rc': 0, 'start': '2024-12-06 17:02:21.251241', 'end': '2024-12-06 17:02:22.309288', 'delta': '0:00:01.058047', 'changed': True, 'invocation': {'module_args': {'_raw_params': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', '_uses_shell': True, 'warn': True, 'stdin_add_newline': True, 'strip_empty_ends': True, 'argv': None, 'chdir': None, 'executable': None, 'creates': None, 'removes': None, 'stdin': None}}, 'stdout_lines': [], 'stderr_lines': [], 'failed': False, 'item': {'service_name': 'VEREDUSPROD_SERVICE', 'db_unique_name': 'OTCHPDUS_UKL', 'preferred_instances': ['OTCHPDUS1', 'OTCHPDUS2'], 'taf_policy': 'BASIC', 'policy': 'AUTOMATIC', 'failover_type': 'SELECT', 'failover_method': 'BASIC', 'failover_retry': 30, 'pdb_name': 'USPD'}, 'ansible_loop_var': 'item'})

TASK [create_service : Display service status msg={{ item.stdout_lines }}] *****
ok: [10.100.36.15] => (item={'cmd': '.  "/home/oracle/OTCHPDUS.env"\nsrvctl status service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" \n', 'stdout': 'Service VEREDUSPROD_SERVICE is running on instance(s) OTCHPDUS1,OTCHPDUS2', 'stderr': '', 'rc': 0, 'start': '2024-12-06 17:02:25.321222', 'end': '2024-12-06 17:02:25.944047', 'delta': '0:00:00.622825', 'changed': True, 'invocation': {'module_args': {'_raw_params': '.  "/home/oracle/OTCHPDUS.env"\nsrvctl status service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" \n', '_uses_shell': True, 'warn': True, 'stdin_add_newline': True, 'strip_empty_ends': True, 'argv': None, 'chdir': None, 'executable': None, 'creates': None, 'removes': None, 'stdin': None}}, 'stdout_lines': ['Service VEREDUSPROD_SERVICE is running on instance(s) OTCHPDUS1,OTCHPDUS2'], 'stderr_lines': [], 'failed': False, 'item': {'cmd': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', 'stdout': '', 'stderr': '', 'rc': 0, 'start': '2024-12-06 17:02:21.251241', 'end': '2024-12-06 17:02:22.309288', 'delta': '0:00:01.058047', 'changed': True, 'invocation': {'module_args': {'_raw_params': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', '_uses_shell': True, 'warn': True, 'stdin_add_newline': True, 'strip_empty_ends': True, 'argv': None, 'chdir': None, 'executable': None, 'creates': None, 'removes': None, 'stdin': None}}, 'stdout_lines': [], 'stderr_lines': [], 'failed': False, 'item': {'service_name': 'VEREDUSPROD_SERVICE', 'db_unique_name': 'OTCHPDUS_UKL', 'preferred_instances': ['OTCHPDUS1', 'OTCHPDUS2'], 'taf_policy': 'BASIC', 'policy': 'AUTOMATIC', 'failover_type': 'SELECT', 'failover_method': 'BASIC', 'failover_retry': 30, 'pdb_name': 'USPD'}, 'ansible_loop_var': 'item'}, 'ansible_loop_var': 'item'}) => {
    "msg": [
        "Service VEREDUSPROD_SERVICE is running on instance(s) OTCHPDUS1,OTCHPDUS2"
    ]
}

TASK [create_service : config services _raw_params=.  "/home/oracle/{{db_name}}.env"
srvctl config service -db "{{ item.item.db_unique_name }}" -service "{{ item.item.service_name }}" 
] ***
changed: [10.100.36.15] => (item={'cmd': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', 'stdout': '', 'stderr': '', 'rc': 0, 'start': '2024-12-06 17:02:21.251241', 'end': '2024-12-06 17:02:22.309288', 'delta': '0:00:01.058047', 'changed': True, 'invocation': {'module_args': {'_raw_params': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', '_uses_shell': True, 'warn': True, 'stdin_add_newline': True, 'strip_empty_ends': True, 'argv': None, 'chdir': None, 'executable': None, 'creates': None, 'removes': None, 'stdin': None}}, 'stdout_lines': [], 'stderr_lines': [], 'failed': False, 'item': {'service_name': 'VEREDUSPROD_SERVICE', 'db_unique_name': 'OTCHPDUS_UKL', 'preferred_instances': ['OTCHPDUS1', 'OTCHPDUS2'], 'taf_policy': 'BASIC', 'policy': 'AUTOMATIC', 'failover_type': 'SELECT', 'failover_method': 'BASIC', 'failover_retry': 30, 'pdb_name': 'USPD'}, 'ansible_loop_var': 'item'})

TASK [create_service : display config service msg={{ item.stdout_lines }}] *****
ok: [10.100.36.15] => (item={'cmd': '.  "/home/oracle/OTCHPDUS.env"\nsrvctl config service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" \n', 'stdout': 'Service name: VEREDUSPROD_SERVICE\nServer pool: \nCardinality: 2\nService role: PRIMARY\nManagement policy: AUTOMATIC\nDTP transaction: false\nAQ HA notifications: false\nGlobal: false\nCommit Outcome: false\nFailover type: SELECT\nFailover method: BASIC\nFailover retries: 30\nFailover delay: \nFailover restore: NONE\nConnection Load Balancing Goal: LONG\nRuntime Load Balancing Goal: NONE\nTAF policy specification: BASIC\nEdition: \nPluggable database name: USPD\nHub service: \nMaximum lag time: ANY\nSQL Translation Profile: \nRetention: 86400 seconds\nReplay Initiation Time: 300 seconds\nDrain timeout: \nStop option: \nSession State Consistency: DYNAMIC\nGSM Flags: 0\nService is enabled\nPreferred instances: OTCHPDUS1,OTCHPDUS2\nAvailable instances: \nCSS critical: no\nService uses Java: false', 'stderr': '', 'rc': 0, 'start': '2024-12-06 17:02:27.102428', 'end': '2024-12-06 17:02:27.836838', 'delta': '0:00:00.734410', 'changed': True, 'invocation': {'module_args': {'_raw_params': '.  "/home/oracle/OTCHPDUS.env"\nsrvctl config service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" \n', '_uses_shell': True, 'warn': True, 'stdin_add_newline': True, 'strip_empty_ends': True, 'argv': None, 'chdir': None, 'executable': None, 'creates': None, 'removes': None, 'stdin': None}}, 'stdout_lines': ['Service name: VEREDUSPROD_SERVICE', 'Server pool: ', 'Cardinality: 2', 'Service role: PRIMARY', 'Management policy: AUTOMATIC', 'DTP transaction: false', 'AQ HA notifications: false', 'Global: false', 'Commit Outcome: false', 'Failover type: SELECT', 'Failover method: BASIC', 'Failover retries: 30', 'Failover delay: ', 'Failover restore: NONE', 'Connection Load Balancing Goal: LONG', 'Runtime Load Balancing Goal: NONE', 'TAF policy specification: BASIC', 'Edition: ', 'Pluggable database name: USPD', 'Hub service: ', 'Maximum lag time: ANY', 'SQL Translation Profile: ', 'Retention: 86400 seconds', 'Replay Initiation Time: 300 seconds', 'Drain timeout: ', 'Stop option: ', 'Session State Consistency: DYNAMIC', 'GSM Flags: 0', 'Service is enabled', 'Preferred instances: OTCHPDUS1,OTCHPDUS2', 'Available instances: ', 'CSS critical: no', 'Service uses Java: false'], 'stderr_lines': [], 'failed': False, 'item': {'cmd': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', 'stdout': '', 'stderr': '', 'rc': 0, 'start': '2024-12-06 17:02:21.251241', 'end': '2024-12-06 17:02:22.309288', 'delta': '0:00:01.058047', 'changed': True, 'invocation': {'module_args': {'_raw_params': '.  "/home/oracle/OTCHPDUS.env"\n/u02/app/oracle/product/19.0.0.0/dbhome_2/bin/srvctl add service -db "OTCHPDUS_UKL" -service "VEREDUSPROD_SERVICE" -preferred "OTCHPDUS1,OTCHPDUS2" -tafpolicy "BASIC" -policy "AUTOMATIC" -failovertype "SELECT" -failovermethod "BASIC" -failoverretry "30" -pdb "USPD"\n', '_uses_shell': True, 'warn': True, 'stdin_add_newline': True, 'strip_empty_ends': True, 'argv': None, 'chdir': None, 'executable': None, 'creates': None, 'removes': None, 'stdin': None}}, 'stdout_lines': [], 'stderr_lines': [], 'failed': False, 'item': {'service_name': 'VEREDUSPROD_SERVICE', 'db_unique_name': 'OTCHPDUS_UKL', 'preferred_instances': ['OTCHPDUS1', 'OTCHPDUS2'], 'taf_policy': 'BASIC', 'policy': 'AUTOMATIC', 'failover_type': 'SELECT', 'failover_method': 'BASIC', 'failover_retry': 30, 'pdb_name': 'USPD'}, 'ansible_loop_var': 'item'}, 'ansible_loop_var': 'item'}) => {
    "msg": [
        "Service name: VEREDUSPROD_SERVICE",
        "Server pool: ",
        "Cardinality: 2",
        "Service role: PRIMARY",
        "Management policy: AUTOMATIC",
        "DTP transaction: false",
        "AQ HA notifications: false",
        "Global: false",
        "Commit Outcome: false",
        "Failover type: SELECT",
        "Failover method: BASIC",
        "Failover retries: 30",
        "Failover delay: ",
        "Failover restore: NONE",
        "Connection Load Balancing Goal: LONG",
        "Runtime Load Balancing Goal: NONE",
        "TAF policy specification: BASIC",
        "Edition: ",
        "Pluggable database name: USPD",
        "Hub service: ",
        "Maximum lag time: ANY",
        "SQL Translation Profile: ",
        "Retention: 86400 seconds",
        "Replay Initiation Time: 300 seconds",
        "Drain timeout: ",
        "Stop option: ",
        "Session State Consistency: DYNAMIC",
        "GSM Flags: 0",
        "Service is enabled",
        "Preferred instances: OTCHPDUS1,OTCHPDUS2",
        "Available instances: ",
        "CSS critical: no",
        "Service uses Java: false"
    ]
}

PLAY [set NLS_ISO_CURRENCY parameter to UNITED KINGDOM] ************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.15]

TASK [pri_set_nls_iso_currency : Set NLS_ISO_CURRENCY to UNITED KINGDOM _raw_params=/usr/bin/dbaascli database modifyParameters --dbname {{db_name }} --setParameters "nls_iso_currency={{ nls_iso_currency }}" --allowBounce
] ***
skipping: [10.100.36.15]

TASK [pri_set_nls_iso_currency : display the nls_iso_currency out var=iso_curr_out.stdout_lines] ***
skipping: [10.100.36.15]

PLAY [configure dispatcher] ****************************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.33]
ok: [10.100.36.15]

TASK [configure_dispatcher : set the db_parameters for dispatchers _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set SHARED_SERVERS={{shared_servers}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set MAX_SHARED_SERVERS={{max_shared_servers}} scope=both sid='*';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set dispatchers='(address=(protocol=tcp)(host={{pri_node1_vip_fq}}))(dispatchers={{dispatchers}})(service={{pri_service_name}})' scope=both sid='{{pri_oracle_sid1}}';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system register;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n show parameter dispatchers;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
skipping: [10.100.36.33]
changed: [10.100.36.15]

TASK [configure_dispatcher : display the dispatcher out on node1 var=dispatcher1_out.stdout_lines] ***
ok: [10.100.36.15] => {
    "dispatcher1_out.stdout_lines": [
        "dispatchers\t\t\t     string",
        "(PROTOCOL=TCP) (SERVICE=OTCHPD",
        "USXDB), (address=(protocol=tcp",
        ")(host=foaukl1pddb-4kxck1-vip.",
        "otchukl1pdexcl.otchukl1pdvcn01",
        ".oraclevcn.com))(dispatchers=5",
        ")(service=VEREDUSPROD_SERVICE)",
        "max_dispatchers \t\t     integer"
    ]
}
skipping: [10.100.36.33]

TASK [configure_dispatcher : set the db_parameters for dispatchers _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system set dispatchers='(address=(protocol=tcp)(host={{pri_node2_vip_fq}}))(dispatchers={{dispatchers}})(service={{pri_service_name}})' scope=both sid='{{pri_oracle_sid2}}';" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n alter system register;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING ON ECHO OFF\n show parameter dispatchers;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
skipping: [10.100.36.15]
changed: [10.100.36.33]

TASK [configure_dispatcher : display the dispatcher out on node2 var=dispatcher2_out.stdout_lines] ***
skipping: [10.100.36.15]
ok: [10.100.36.33] => {
    "dispatcher2_out.stdout_lines": [
        "dispatchers\t\t\t     string",
        "(PROTOCOL=TCP) (SERVICE=OTCHPD",
        "USXDB), (address=(protocol=tcp",
        ")(host=foaukl1pddb-4kxck2-vip.",
        "otchukl1pdexcl.otchukl1pdvcn01",
        ".oraclevcn.com))(dispatchers=5",
        ")(service=VEREDUSPROD_SERVICE)",
        "max_dispatchers \t\t     integer"
    ]
}

PLAY [create object storage buckets for RMAN backups] **************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.16.29]

TASK [pri_create_buckets : create standard object storage bucket for OTCHPDUS backups compartment_id={{ pri_compartment_id }}, namespace_name={{ pri_namespace }}, name={{ pri_std_backup_bucket }}, storage_tier=Standard, public_access_type=NoPublicAccess, state=present] ***
ok: [10.100.16.29]

TASK [pri_create_buckets : display the  standard bucket details msg={{ std_bucket_out }}] ***
ok: [10.100.16.29] => {
    "msg": {
        "bucket": {
            "approximate_count": 109,
            "approximate_size": 1884701108,
            "auto_tiering": "Disabled",
            "compartment_id": "ocid1.compartment.oc1..aaaaaaaalj2ziyzctjkbhcdszxnkhvf3ijaagfwzmrf7ffi5hvwejazyr2wq",
            "created_by": "ocid1.user.oc1..aaaaaaaaumutv3ir274bhmxeht4532c6eqnjp5637kova2pomaunmarmoqma",
            "defined_tags": {
                "Hays-Tags": {
                    "AppName": "OneTouch Exa Prod",
                    "AppOwner": "Front Office",
                    "BillableTo": "UK ITPS",
                    "Environment": "Prod",
                    "TechnicalOwner": "Front Office"
                },
                "Oracle-Tags": {
                    "CreatedBy": "default/ansibleadmin",
                    "CreatedOn": "2024-10-15T14:40:39.040Z"
                }
            },
            "etag": "a7875627-97cf-4744-a3cc-917f05700d49",
            "freeform_tags": {},
            "id": "ocid1.bucket.oc1.uk-london-1.aaaaaaaa6qwpvc6sqgn7lz4ofszxa3gzsvri5wvhw7dypq47fdaidzk2k3dq",
            "is_read_only": false,
            "kms_key_id": null,
            "metadata": {},
            "name": "foa-ukl1-pd-otchpdus-std-backup",
            "namespace": "lraob35idcqp",
            "object_events_enabled": false,
            "object_lifecycle_policy_etag": null,
            "public_access_type": "NoPublicAccess",
            "replication_enabled": false,
            "storage_tier": "Standard",
            "time_created": "2024-10-15T14:40:39.057000+00:00",
            "versioning": "Disabled"
        },
        "changed": false,
        "failed": false
    }
}

TASK [pri_create_buckets : create Archive object storage bucket for OTCHPDUS backups compartment_id={{ pri_compartment_id }}, namespace_name={{ pri_namespace }}, name={{ pri_arc_backup_bucket }}, storage_tier=Archive, public_access_type=NoPublicAccess, state=present] ***
ok: [10.100.16.29]

TASK [pri_create_buckets : display the archive bucket details msg={{ arc_bucket_out }}] ***
ok: [10.100.16.29] => {
    "msg": {
        "bucket": {
            "approximate_count": 0,
            "approximate_size": 0,
            "auto_tiering": "Disabled",
            "compartment_id": "ocid1.compartment.oc1..aaaaaaaalj2ziyzctjkbhcdszxnkhvf3ijaagfwzmrf7ffi5hvwejazyr2wq",
            "created_by": "ocid1.user.oc1..aaaaaaaaumutv3ir274bhmxeht4532c6eqnjp5637kova2pomaunmarmoqma",
            "defined_tags": {
                "Hays-Tags": {
                    "AppName": "OneTouch Exa Prod",
                    "AppOwner": "Front Office",
                    "BillableTo": "UK ITPS",
                    "Environment": "Prod",
                    "TechnicalOwner": "Front Office"
                },
                "Oracle-Tags": {
                    "CreatedBy": "default/ansibleadmin",
                    "CreatedOn": "2024-10-15T14:40:40.395Z"
                }
            },
            "etag": "7e699ec4-06a6-42af-aa63-a4e684ab993e",
            "freeform_tags": {},
            "id": "ocid1.bucket.oc1.uk-london-1.aaaaaaaaihfzwnlxctp65qzjrkk2z5nwuky55sb4re7srkwhoefhwldm56pa",
            "is_read_only": false,
            "kms_key_id": null,
            "metadata": {},
            "name": "foa-ukl1-pd-otchpdus-arch-backup",
            "namespace": "lraob35idcqp",
            "object_events_enabled": false,
            "object_lifecycle_policy_etag": null,
            "public_access_type": "NoPublicAccess",
            "replication_enabled": false,
            "storage_tier": "Archive",
            "time_created": "2024-10-15T14:40:40.411000+00:00",
            "versioning": "Disabled"
        },
        "changed": false,
        "failed": false
    }
}

PLAY [do backup prereqs] *******************************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.33]
ok: [10.100.36.15]

TASK [pri_backup_prereqs : check RMANCAT_RMPD tns_entry already exists  in tnsnames.ora file paths={{ pri_tns_admin }}, patterns=tnsnames.ora, contains=# Ansible managed block RMANCAT_RMPD] ***
ok: [10.100.36.15]
ok: [10.100.36.33]

TASK [pri_backup_prereqs : Add RMANCAT_RMPD tns entry with markers path={{ pri_tns_admin }}/tnsnames.ora, block={{ rmancat_tns_entry }}, marker=# Ansible managed block RMANCAT_RMPD, insertafter=EOF, state=present] ***
changed: [10.100.36.33]
changed: [10.100.36.15]

TASK [pri_backup_prereqs : create backup config files for OTCHPDUS src={{ item.src }}, dest={{ item.dest }}, owner=oracle, group=oinstall, mode=u=rw,g=r,o=r] ***
ok: [10.100.36.33] => (item={'src': 'pri_opc_database_STD.ora.j2', 'dest': '/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora'})
ok: [10.100.36.15] => (item={'src': 'pri_opc_database_STD.ora.j2', 'dest': '/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora'})
ok: [10.100.36.33] => (item={'src': 'pri_opc_database_ARC.ora.j2', 'dest': '/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora'})
ok: [10.100.36.15] => (item={'src': 'pri_opc_database_ARC.ora.j2', 'dest': '/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora'})

TASK [pri_backup_prereqs : display backup config out msg={{ backup_conf_out }}] ***
ok: [10.100.36.15] => {
    "msg": {
        "changed": false,
        "msg": "All items completed",
        "results": [
            {
                "ansible_loop_var": "item",
                "changed": false,
                "checksum": "55b48c79f2aa5c8bb61b90cbfe5c8d5f79ca07df",
                "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                "diff": {
                    "after": {
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora"
                    },
                    "before": {
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora"
                    }
                },
                "failed": false,
                "gid": 1001,
                "group": "oinstall",
                "invocation": {
                    "module_args": {
                        "_diff_peek": null,
                        "_original_basename": "pri_opc_database_STD.ora.j2",
                        "access_time": null,
                        "access_time_format": "%Y%m%d%H%M.%S",
                        "attributes": null,
                        "backup": null,
                        "content": null,
                        "delimiter": null,
                        "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                        "directory_mode": null,
                        "follow": false,
                        "force": false,
                        "group": "oinstall",
                        "mode": "u=rw,g=r,o=r",
                        "modification_time": null,
                        "modification_time_format": "%Y%m%d%H%M.%S",
                        "owner": "oracle",
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                        "recurse": false,
                        "regexp": null,
                        "remote_src": null,
                        "selevel": null,
                        "serole": null,
                        "setype": null,
                        "seuser": null,
                        "src": null,
                        "state": "file",
                        "unsafe_writes": false
                    }
                },
                "item": {
                    "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                    "src": "pri_opc_database_STD.ora.j2"
                },
                "mode": "0644",
                "owner": "oracle",
                "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                "size": 347,
                "state": "file",
                "uid": 1001
            },
            {
                "ansible_loop_var": "item",
                "changed": false,
                "checksum": "9b2c00199158cc590c640718db5487322084a30b",
                "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                "diff": {
                    "after": {
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora"
                    },
                    "before": {
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora"
                    }
                },
                "failed": false,
                "gid": 1001,
                "group": "oinstall",
                "invocation": {
                    "module_args": {
                        "_diff_peek": null,
                        "_original_basename": "pri_opc_database_ARC.ora.j2",
                        "access_time": null,
                        "access_time_format": "%Y%m%d%H%M.%S",
                        "attributes": null,
                        "backup": null,
                        "content": null,
                        "delimiter": null,
                        "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                        "directory_mode": null,
                        "follow": false,
                        "force": false,
                        "group": "oinstall",
                        "mode": "u=rw,g=r,o=r",
                        "modification_time": null,
                        "modification_time_format": "%Y%m%d%H%M.%S",
                        "owner": "oracle",
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                        "recurse": false,
                        "regexp": null,
                        "remote_src": null,
                        "selevel": null,
                        "serole": null,
                        "setype": null,
                        "seuser": null,
                        "src": null,
                        "state": "file",
                        "unsafe_writes": false
                    }
                },
                "item": {
                    "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                    "src": "pri_opc_database_ARC.ora.j2"
                },
                "mode": "0644",
                "owner": "oracle",
                "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                "size": 348,
                "state": "file",
                "uid": 1001
            }
        ]
    }
}
ok: [10.100.36.33] => {
    "msg": {
        "changed": false,
        "msg": "All items completed",
        "results": [
            {
                "ansible_loop_var": "item",
                "changed": false,
                "checksum": "55b48c79f2aa5c8bb61b90cbfe5c8d5f79ca07df",
                "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                "diff": {
                    "after": {
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora"
                    },
                    "before": {
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora"
                    }
                },
                "failed": false,
                "gid": 1001,
                "group": "oinstall",
                "invocation": {
                    "module_args": {
                        "_diff_peek": null,
                        "_original_basename": "pri_opc_database_STD.ora.j2",
                        "access_time": null,
                        "access_time_format": "%Y%m%d%H%M.%S",
                        "attributes": null,
                        "backup": null,
                        "content": null,
                        "delimiter": null,
                        "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                        "directory_mode": null,
                        "follow": false,
                        "force": false,
                        "group": "oinstall",
                        "mode": "u=rw,g=r,o=r",
                        "modification_time": null,
                        "modification_time_format": "%Y%m%d%H%M.%S",
                        "owner": "oracle",
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                        "recurse": false,
                        "regexp": null,
                        "remote_src": null,
                        "selevel": null,
                        "serole": null,
                        "setype": null,
                        "seuser": null,
                        "src": null,
                        "state": "file",
                        "unsafe_writes": false
                    }
                },
                "item": {
                    "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                    "src": "pri_opc_database_STD.ora.j2"
                },
                "mode": "0644",
                "owner": "oracle",
                "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora",
                "size": 347,
                "state": "file",
                "uid": 1001
            },
            {
                "ansible_loop_var": "item",
                "changed": false,
                "checksum": "9b2c00199158cc590c640718db5487322084a30b",
                "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                "diff": {
                    "after": {
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora"
                    },
                    "before": {
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora"
                    }
                },
                "failed": false,
                "gid": 1001,
                "group": "oinstall",
                "invocation": {
                    "module_args": {
                        "_diff_peek": null,
                        "_original_basename": "pri_opc_database_ARC.ora.j2",
                        "access_time": null,
                        "access_time_format": "%Y%m%d%H%M.%S",
                        "attributes": null,
                        "backup": null,
                        "content": null,
                        "delimiter": null,
                        "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                        "directory_mode": null,
                        "follow": false,
                        "force": false,
                        "group": "oinstall",
                        "mode": "u=rw,g=r,o=r",
                        "modification_time": null,
                        "modification_time_format": "%Y%m%d%H%M.%S",
                        "owner": "oracle",
                        "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                        "recurse": false,
                        "regexp": null,
                        "remote_src": null,
                        "selevel": null,
                        "serole": null,
                        "setype": null,
                        "seuser": null,
                        "src": null,
                        "state": "file",
                        "unsafe_writes": false
                    }
                },
                "item": {
                    "dest": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                    "src": "pri_opc_database_ARC.ora.j2"
                },
                "mode": "0644",
                "owner": "oracle",
                "path": "/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_ARC.ora",
                "size": 348,
                "state": "file",
                "uid": 1001
            }
        ]
    }
}

TASK [pri_backup_prereqs : Get current timestamp _raw_params=date +%Y%m%d%H%M%S] ***
changed: [10.100.36.33]
changed: [10.100.36.15]

TASK [pri_backup_prereqs : backup the existing crontab entries _raw_params=crontab -l] ***
changed: [10.100.36.33]
changed: [10.100.36.15]

TASK [pri_backup_prereqs : Save crontab entries to a file content={{ cron_entries.stdout }}, dest=/home/oracle/crontab_entries_{{timestamp.stdout}}.txt, mode=384] ***
changed: [10.100.36.33]
changed: [10.100.36.15]

TASK [pri_backup_prereqs : schedule backup cron jobs in crontab name={{ item.name }}, minute={{ item.minute }}, hour={{ item.hour }}, day={{ item.day }}, month={{ item.month }}, weekday={{ item.weekday }}, job={{ item.job }}, state=present, disabled={{ item.disabled }}] ***
ok: [10.100.36.15] => (item={'name': 'Level 0 backup for OTCHPDUS', 'minute': '00', 'hour': '03', 'day': '*', 'month': '*', 'weekday': '0', 'job': "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 0 8 >> /home/oracle/version1/RMANscripts/log/full_OTCHPDUS.log'", 'disabled': True})
ok: [10.100.36.33] => (item={'name': 'Level 0 backup for OTCHPDUS', 'minute': '00', 'hour': '03', 'day': '*', 'month': '*', 'weekday': '0', 'job': "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 0 8 >> /home/oracle/version1/RMANscripts/log/full_OTCHPDUS.log'", 'disabled': True})
ok: [10.100.36.15] => (item={'name': 'Level 1 backup for OTCHPDUS', 'minute': '00', 'hour': '03', 'day': '*', 'month': '*', 'weekday': '1-6', 'job': "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 1 8 >> /home/oracle/version1/RMANscripts/log/incr_OTCHPDUS.log'", 'disabled': True})
ok: [10.100.36.33] => (item={'name': 'Level 1 backup for OTCHPDUS', 'minute': '00', 'hour': '03', 'day': '*', 'month': '*', 'weekday': '1-6', 'job': "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 1 8 >> /home/oracle/version1/RMANscripts/log/incr_OTCHPDUS.log'", 'disabled': True})

TASK [pri_backup_prereqs : display the scheduled cron jobs msg={{ cron_out }}] ***
ok: [10.100.36.15] => {
    "msg": {
        "changed": false,
        "msg": "All items completed",
        "results": [
            {
                "ansible_loop_var": "item",
                "changed": false,
                "envs": [],
                "failed": false,
                "invocation": {
                    "module_args": {
                        "backup": false,
                        "cron_file": null,
                        "day": "*",
                        "disabled": true,
                        "env": null,
                        "hour": "03",
                        "insertafter": null,
                        "insertbefore": null,
                        "job": "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 0 8 >> /home/oracle/version1/RMANscripts/log/full_OTCHPDUS.log'",
                        "minute": "00",
                        "month": "*",
                        "name": "Level 0 backup for OTCHPDUS",
                        "reboot": false,
                        "special_time": null,
                        "state": "present",
                        "user": null,
                        "weekday": "0"
                    }
                },
                "item": {
                    "day": "*",
                    "disabled": true,
                    "hour": "03",
                    "job": "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 0 8 >> /home/oracle/version1/RMANscripts/log/full_OTCHPDUS.log'",
                    "minute": "00",
                    "month": "*",
                    "name": "Level 0 backup for OTCHPDUS",
                    "weekday": "0"
                },
                "jobs": [
                    "Monthly Level 0 Archive backup for OTCHCLFR testing",
                    "Monthly archive backup for OTCHCLFR testing",
                    "Level 0 backup for OTCHCLFR",
                    "Level 1 backup for OTCHCLFR",
                    "Level 0 backup for OTCHPDUK",
                    "Level 1 backup for OTCHPDUK",
                    "Level 0 backup for OTCHPDFR",
                    "Level 1 backup for OTCHPDFR",
                    "Level 0 backup for OTCHPDIO",
                    "Level 1 backup for OTCHPDIO",
                    "Level 0 backup for OTCHPDUS",
                    "Level 1 backup for OTCHPDUS",
                    "Level 0 backup for OTCHPDMX",
                    "Level 1 backup for OTCHPDMX",
                    "Monthly archive backup for OTCHPDUK",
                    "Monthly archive backup for OTCHPDFR",
                    "Monthly archive backup for OTCHPDIE",
                    "Monthly archive backup for OTCHPDCA",
                    "Monthly archive backup for OTCHPDBR",
                    "Monthly archive backup for OTCHPDIO",
                    "Level 0 backup for OTCHPDPT",
                    "Level 1 backup for OTCHPDPT",
                    "Level 0 backup for OTCHPDIT",
                    "Level 1 backup for OTCHPDIT",
                    "Level 0 backup for OTCHPDES",
                    "Level 1 backup for OTCHPDES"
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": false,
                "envs": [],
                "failed": false,
                "invocation": {
                    "module_args": {
                        "backup": false,
                        "cron_file": null,
                        "day": "*",
                        "disabled": true,
                        "env": null,
                        "hour": "03",
                        "insertafter": null,
                        "insertbefore": null,
                        "job": "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 1 8 >> /home/oracle/version1/RMANscripts/log/incr_OTCHPDUS.log'",
                        "minute": "00",
                        "month": "*",
                        "name": "Level 1 backup for OTCHPDUS",
                        "reboot": false,
                        "special_time": null,
                        "state": "present",
                        "user": null,
                        "weekday": "1-6"
                    }
                },
                "item": {
                    "day": "*",
                    "disabled": true,
                    "hour": "03",
                    "job": "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 1 8 >> /home/oracle/version1/RMANscripts/log/incr_OTCHPDUS.log'",
                    "minute": "00",
                    "month": "*",
                    "name": "Level 1 backup for OTCHPDUS",
                    "weekday": "1-6"
                },
                "jobs": [
                    "Monthly Level 0 Archive backup for OTCHCLFR testing",
                    "Monthly archive backup for OTCHCLFR testing",
                    "Level 0 backup for OTCHCLFR",
                    "Level 1 backup for OTCHCLFR",
                    "Level 0 backup for OTCHPDUK",
                    "Level 1 backup for OTCHPDUK",
                    "Level 0 backup for OTCHPDFR",
                    "Level 1 backup for OTCHPDFR",
                    "Level 0 backup for OTCHPDIO",
                    "Level 1 backup for OTCHPDIO",
                    "Level 0 backup for OTCHPDUS",
                    "Level 1 backup for OTCHPDUS",
                    "Level 0 backup for OTCHPDMX",
                    "Level 1 backup for OTCHPDMX",
                    "Monthly archive backup for OTCHPDUK",
                    "Monthly archive backup for OTCHPDFR",
                    "Monthly archive backup for OTCHPDIE",
                    "Monthly archive backup for OTCHPDCA",
                    "Monthly archive backup for OTCHPDBR",
                    "Monthly archive backup for OTCHPDIO",
                    "Level 0 backup for OTCHPDPT",
                    "Level 1 backup for OTCHPDPT",
                    "Level 0 backup for OTCHPDIT",
                    "Level 1 backup for OTCHPDIT",
                    "Level 0 backup for OTCHPDES",
                    "Level 1 backup for OTCHPDES"
                ]
            }
        ]
    }
}
ok: [10.100.36.33] => {
    "msg": {
        "changed": false,
        "msg": "All items completed",
        "results": [
            {
                "ansible_loop_var": "item",
                "changed": false,
                "envs": [],
                "failed": false,
                "invocation": {
                    "module_args": {
                        "backup": false,
                        "cron_file": null,
                        "day": "*",
                        "disabled": true,
                        "env": null,
                        "hour": "03",
                        "insertafter": null,
                        "insertbefore": null,
                        "job": "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 0 8 >> /home/oracle/version1/RMANscripts/log/full_OTCHPDUS.log'",
                        "minute": "00",
                        "month": "*",
                        "name": "Level 0 backup for OTCHPDUS",
                        "reboot": false,
                        "special_time": null,
                        "state": "present",
                        "user": null,
                        "weekday": "0"
                    }
                },
                "item": {
                    "day": "*",
                    "disabled": true,
                    "hour": "03",
                    "job": "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 0 8 >> /home/oracle/version1/RMANscripts/log/full_OTCHPDUS.log'",
                    "minute": "00",
                    "month": "*",
                    "name": "Level 0 backup for OTCHPDUS",
                    "weekday": "0"
                },
                "jobs": [
                    "Level 0 backup for OTCHPDFR",
                    "Level 1 backup for OTCHPDFR",
                    "Level 0 backup for OTCHCLFR",
                    "Level 1 backup for OTCHCLFR",
                    "Level 0 backup for OTCHPDUK",
                    "Level 1 backup for OTCHPDUK",
                    "Level 0 backup for OTCHCLUK",
                    "Level 1 backup for OTCHCLUK",
                    "Level 0 backup for OTCHPDCA",
                    "Level 1 backup for OTCHPDCA",
                    "Level 0 backup for OTCHPDBR",
                    "Level 1 backup for OTCHPDBR",
                    "Level 0 backup for OTCHPDIO",
                    "Level 1 backup for OTCHPDIO",
                    "Level 0 backup for OTCHPDUS",
                    "Level 1 backup for OTCHPDUS",
                    "Level 0 backup for OTCHPDMX",
                    "Level 1 backup for OTCHPDMX",
                    "Monthly archive backup for OTCHPDUK",
                    "Monthly archive backup for OTCHPDFR",
                    "Monthly archive backup for OTCHPDIE",
                    "Level 0 backup for OTCHPDPT",
                    "Level 1 backup for OTCHPDPT",
                    "Level 0 backup for OTCHPDIT",
                    "Level 1 backup for OTCHPDIT",
                    "Level 0 backup for OTCHPDES",
                    "Level 1 backup for OTCHPDES"
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": false,
                "envs": [],
                "failed": false,
                "invocation": {
                    "module_args": {
                        "backup": false,
                        "cron_file": null,
                        "day": "*",
                        "disabled": true,
                        "env": null,
                        "hour": "03",
                        "insertafter": null,
                        "insertbefore": null,
                        "job": "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 1 8 >> /home/oracle/version1/RMANscripts/log/incr_OTCHPDUS.log'",
                        "minute": "00",
                        "month": "*",
                        "name": "Level 1 backup for OTCHPDUS",
                        "reboot": false,
                        "special_time": null,
                        "state": "present",
                        "user": null,
                        "weekday": "1-6"
                    }
                },
                "item": {
                    "day": "*",
                    "disabled": true,
                    "hour": "03",
                    "job": "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 1 8 >> /home/oracle/version1/RMANscripts/log/incr_OTCHPDUS.log'",
                    "minute": "00",
                    "month": "*",
                    "name": "Level 1 backup for OTCHPDUS",
                    "weekday": "1-6"
                },
                "jobs": [
                    "Level 0 backup for OTCHPDFR",
                    "Level 1 backup for OTCHPDFR",
                    "Level 0 backup for OTCHCLFR",
                    "Level 1 backup for OTCHCLFR",
                    "Level 0 backup for OTCHPDUK",
                    "Level 1 backup for OTCHPDUK",
                    "Level 0 backup for OTCHCLUK",
                    "Level 1 backup for OTCHCLUK",
                    "Level 0 backup for OTCHPDCA",
                    "Level 1 backup for OTCHPDCA",
                    "Level 0 backup for OTCHPDBR",
                    "Level 1 backup for OTCHPDBR",
                    "Level 0 backup for OTCHPDIO",
                    "Level 1 backup for OTCHPDIO",
                    "Level 0 backup for OTCHPDUS",
                    "Level 1 backup for OTCHPDUS",
                    "Level 0 backup for OTCHPDMX",
                    "Level 1 backup for OTCHPDMX",
                    "Monthly archive backup for OTCHPDUK",
                    "Monthly archive backup for OTCHPDFR",
                    "Monthly archive backup for OTCHPDIE",
                    "Level 0 backup for OTCHPDPT",
                    "Level 1 backup for OTCHPDPT",
                    "Level 0 backup for OTCHPDIT",
                    "Level 1 backup for OTCHPDIT",
                    "Level 0 backup for OTCHPDES",
                    "Level 1 backup for OTCHPDES"
                ]
            }
        ]
    }
}

PLAY [enable_RMAN_BACKUPS] *****************************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.15]

TASK [pri_enable_backup : create a common rman_user for the RMAN backups _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n CREATE USER {{rman_user}} IDENTIFIED BY {{rman_password}} DEFAULT TABLESPACE users TEMPORARY TABLESPACE TEMP PROFILE DEFAULT ACCOUNT UNLOCK;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "SET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\n grant sysbackup to {{rman_user}} container=all;" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
echo -e "show all;" | {{ pri_oracle_home }}/bin/rman target '"{{ rman_user }}/{{rman_password}}@{{ db_name }}_{{ pri_region_identifier }} as sysbackup"'
] ***
changed: [10.100.36.15]

TASK [pri_enable_backup : display rman_out var=rman_out.stdout_lines] **********
ok: [10.100.36.15] => {
    "rman_out.stdout_lines": [
        "",
        "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:03:04 2024",
        "Version 19.23.0.0.0",
        "",
        "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
        "",
        "connected to target database: OTCHPDUS (DBID=294426370)",
        "",
        "RMAN> ",
        "using target database control file instead of recovery catalog",
        "RMAN configuration parameters for database with db_unique_name OTCHPDUS_UKL are:",
        "CONFIGURE RETENTION POLICY TO REDUNDANCY 1; # default",
        "CONFIGURE BACKUP OPTIMIZATION OFF; # default",
        "CONFIGURE DEFAULT DEVICE TYPE TO DISK; # default",
        "CONFIGURE CONTROLFILE AUTOBACKUP ON; # default",
        "CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F'; # default",
        "CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO BACKUPSET; # default",
        "CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default",
        "CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default",
        "CONFIGURE MAXSETSIZE TO UNLIMITED; # default",
        "CONFIGURE ENCRYPTION FOR DATABASE OFF; # default",
        "CONFIGURE ENCRYPTION ALGORITHM 'AES128'; # default",
        "CONFIGURE COMPRESSION ALGORITHM 'BASIC' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE ; # default",
        "CONFIGURE RMAN OUTPUT TO KEEP FOR 7 DAYS; # default",
        "CONFIGURE ARCHIVELOG DELETION POLICY TO NONE; # default",
        "CONFIGURE SNAPSHOT CONTROLFILE NAME TO '+RECOC1/OTCHPDUS_UKL/controlfile/snapcf_OTCHPDUS.f';",
        "",
        "RMAN> ",
        "",
        "Recovery Manager complete."
    ]
}

TASK [pri_enable_backup : register database OTCHPDUS with rmancatalog database _raw_params=.  "/home/oracle/{{ db_name }}.env"
echo -e "{{ item }};" | {{ pri_oracle_home }}/bin/rman target '"{{ rman_user }}/{{rman_password}}@{{ db_name }}_{{ pri_region_identifier }} as sysbackup"' catalog {{ rmancat_user }}/{{ rmancat_password }}@RMANCAT_RMPD  
] ***
changed: [10.100.36.15] => (item=REGISTER DATABASE)
changed: [10.100.36.15] => (item=list db_unique_name all)
changed: [10.100.36.15] => (item=CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 32 DAYS)
changed: [10.100.36.15] => (item=CONFIGURE BACKUP OPTIMIZATION ON)
changed: [10.100.36.15] => (item=CONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE')
changed: [10.100.36.15] => (item=CONFIGURE CONTROLFILE AUTOBACKUP ON)
changed: [10.100.36.15] => (item=CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE SBT_TAPE TO '%F')
changed: [10.100.36.15] => (item=CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO COMPRESSED BACKUPSET)
changed: [10.100.36.15] => (item=CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS 'SBT_LIBRARY=/home/oracle/version1/RMANscripts/OPC/lib/libopc.so, ENV=(OPC_PFILE=/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora)')
changed: [10.100.36.15] => (item=CONFIGURE ENCRYPTION FOR DATABASE ON)
changed: [10.100.36.15] => (item=CONFIGURE ENCRYPTION ALGORITHM 'AES256')
changed: [10.100.36.15] => (item=CONFIGURE COMPRESSION ALGORITHM 'LOW' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE)
changed: [10.100.36.15] => (item=CONFIGURE RMAN OUTPUT TO KEEP FOR 100 DAYS)
changed: [10.100.36.15] => (item=CONFIGURE ARCHIVELOG DELETION POLICY TO APPLIED ON ALL STANDBY BACKED UP 1 TIMES TO 'SBT_TAPE')
changed: [10.100.36.15] => (item=show all)

TASK [pri_enable_backup : display rman configuration settings var=rman_conf_out] ***
ok: [10.100.36.15] => {
    "rman_conf_out": {
        "changed": true,
        "msg": "All items completed",
        "results": [
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"REGISTER DATABASE;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:14.528878",
                "end": "2024-12-06 17:03:31.497770",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"REGISTER DATABASE;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "REGISTER DATABASE",
                "rc": 0,
                "start": "2024-12-06 17:03:16.968892",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:03:16 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \ndatabase registered in recovery catalog\nstarting full resync of recovery catalog\nfull resync complete\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:03:16 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "database registered in recovery catalog",
                    "starting full resync of recovery catalog",
                    "full resync complete",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"list db_unique_name all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:11.721138",
                "end": "2024-12-06 17:03:44.261085",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"list db_unique_name all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "list db_unique_name all",
                "rc": 0,
                "start": "2024-12-06 17:03:32.539947",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:03:32 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \n\nList of Databases\nDB Key  DB Name  DB ID            Database Role    Db_unique_name\n------- ------- ----------------- ---------------  ------------------\n396655  OTCHPDCA 79961585         PRIMARY          OTCHPDCA_UKL        \n396655  OTCHPDCA 79961585         STANDBY          OTCHPDCA_UKC        \n552803  OTCHPDUS 289842088        PRIMARY          OTCHPDUS_UKL        \n1218289 OTCHPDUS 294426370        PRIMARY          OTCHPDUS_UKL        \n1       OTCHPDIE 513854901        PRIMARY          OTCHPDIE_UKL        \n1       OTCHPDIE 513854901        STANDBY          OTCHPDIE_UKC        \n466674  OTCHPDUK 598712305        PRIMARY          OTCHPDUK_UKL        \n466674  OTCHPDUK 598712305        STANDBY          OTCHPDUK_UKC        \n769640  OTCHPDPT 661832476        PRIMARY          OTCHPDPT_UKL        \n1042672 OTCHPDIT 1362570761       PRIMARY          OTCHPDIT_UKL        \n503283  OTCHPDIO 1463074439       PRIMARY          OTCHPDIO_UKL        \n503283  OTCHPDIO 1463074439       STANDBY          OTCHPDIO_UKC        \n142480  OTCHCLFR 2291172391       PRIMARY          OTCHCLFR_UKL        \n142480  OTCHCLFR 2291172391       STANDBY          OTCHCLFR_UKC        \n188163  OTCHPDFR 3039501250       PRIMARY          OTCHPDFR_UKL        \n188163  OTCHPDFR 3039501250       STANDBY          OTCHPDFR_UKC        \n1162059 OTCHPDES 3351797981       PRIMARY          OTCHPDES_UKL        \n456503  OTCHPDBR 3440234130       PRIMARY          OTCHPDBR_UKL        \n456503  OTCHPDBR 3440234130       STANDBY          OTCHPDBR_UKC        \n655292  OTCHPDMX 3686099432       PRIMARY          OTCHPDMX_UKL        \n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:03:32 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "",
                    "List of Databases",
                    "DB Key  DB Name  DB ID            Database Role    Db_unique_name",
                    "------- ------- ----------------- ---------------  ------------------",
                    "396655  OTCHPDCA 79961585         PRIMARY          OTCHPDCA_UKL        ",
                    "396655  OTCHPDCA 79961585         STANDBY          OTCHPDCA_UKC        ",
                    "552803  OTCHPDUS 289842088        PRIMARY          OTCHPDUS_UKL        ",
                    "1218289 OTCHPDUS 294426370        PRIMARY          OTCHPDUS_UKL        ",
                    "1       OTCHPDIE 513854901        PRIMARY          OTCHPDIE_UKL        ",
                    "1       OTCHPDIE 513854901        STANDBY          OTCHPDIE_UKC        ",
                    "466674  OTCHPDUK 598712305        PRIMARY          OTCHPDUK_UKL        ",
                    "466674  OTCHPDUK 598712305        STANDBY          OTCHPDUK_UKC        ",
                    "769640  OTCHPDPT 661832476        PRIMARY          OTCHPDPT_UKL        ",
                    "1042672 OTCHPDIT 1362570761       PRIMARY          OTCHPDIT_UKL        ",
                    "503283  OTCHPDIO 1463074439       PRIMARY          OTCHPDIO_UKL        ",
                    "503283  OTCHPDIO 1463074439       STANDBY          OTCHPDIO_UKC        ",
                    "142480  OTCHCLFR 2291172391       PRIMARY          OTCHCLFR_UKL        ",
                    "142480  OTCHCLFR 2291172391       STANDBY          OTCHCLFR_UKC        ",
                    "188163  OTCHPDFR 3039501250       PRIMARY          OTCHPDFR_UKL        ",
                    "188163  OTCHPDFR 3039501250       STANDBY          OTCHPDFR_UKC        ",
                    "1162059 OTCHPDES 3351797981       PRIMARY          OTCHPDES_UKL        ",
                    "456503  OTCHPDBR 3440234130       PRIMARY          OTCHPDBR_UKL        ",
                    "456503  OTCHPDBR 3440234130       STANDBY          OTCHPDBR_UKC        ",
                    "655292  OTCHPDMX 3686099432       PRIMARY          OTCHPDMX_UKL        ",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 32 DAYS;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:13.378169",
                "end": "2024-12-06 17:03:58.649497",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 32 DAYS;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 32 DAYS",
                "rc": 0,
                "start": "2024-12-06 17:03:45.271328",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:03:45 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 32 DAYS;\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:03:45 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 32 DAYS;",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE BACKUP OPTIMIZATION ON;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:12.689291",
                "end": "2024-12-06 17:04:12.343043",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE BACKUP OPTIMIZATION ON;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE BACKUP OPTIMIZATION ON",
                "rc": 0,
                "start": "2024-12-06 17:03:59.653752",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:03:59 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE BACKUP OPTIMIZATION ON;\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:03:59 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE BACKUP OPTIMIZATION ON;",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:12.863712",
                "end": "2024-12-06 17:04:26.231188",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE'",
                "rc": 0,
                "start": "2024-12-06 17:04:13.367476",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:04:13 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE';\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:04:13 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE';",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE CONTROLFILE AUTOBACKUP ON;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:13.272968",
                "end": "2024-12-06 17:04:40.591243",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE CONTROLFILE AUTOBACKUP ON;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE CONTROLFILE AUTOBACKUP ON",
                "rc": 0,
                "start": "2024-12-06 17:04:27.318275",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:04:27 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE CONTROLFILE AUTOBACKUP ON;\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:04:27 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE CONTROLFILE AUTOBACKUP ON;",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE SBT_TAPE TO '%F';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:13.061253",
                "end": "2024-12-06 17:04:54.671573",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE SBT_TAPE TO '%F';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE SBT_TAPE TO '%F'",
                "rc": 0,
                "start": "2024-12-06 17:04:41.610320",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:04:41 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE 'SBT_TAPE' TO '%F';\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:04:41 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE 'SBT_TAPE' TO '%F';",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO COMPRESSED BACKUPSET;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:12.596727",
                "end": "2024-12-06 17:05:08.212616",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO COMPRESSED BACKUPSET;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO COMPRESSED BACKUPSET",
                "rc": 0,
                "start": "2024-12-06 17:04:55.615889",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:04:55 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO COMPRESSED BACKUPSET;\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:04:55 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO COMPRESSED BACKUPSET;",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS 'SBT_LIBRARY=/home/oracle/version1/RMANscripts/OPC/lib/libopc.so, ENV=(OPC_PFILE=/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora)';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:13.273436",
                "end": "2024-12-06 17:05:22.505516",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS 'SBT_LIBRARY=/home/oracle/version1/RMANscripts/OPC/lib/libopc.so, ENV=(OPC_PFILE=/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora)';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS 'SBT_LIBRARY=/home/oracle/version1/RMANscripts/OPC/lib/libopc.so, ENV=(OPC_PFILE=/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora)'",
                "rc": 0,
                "start": "2024-12-06 17:05:09.232080",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:05:09 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS  'SBT_LIBRARY=/home/oracle/version1/RMANscripts/OPC/lib/libopc.so, ENV=(OPC_PFILE=/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora)';\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:05:09 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS  'SBT_LIBRARY=/home/oracle/version1/RMANscripts/OPC/lib/libopc.so, ENV=(OPC_PFILE=/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora)';",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE ENCRYPTION FOR DATABASE ON;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:13.520307",
                "end": "2024-12-06 17:05:37.035904",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE ENCRYPTION FOR DATABASE ON;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE ENCRYPTION FOR DATABASE ON",
                "rc": 0,
                "start": "2024-12-06 17:05:23.515597",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:05:23 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE ENCRYPTION FOR DATABASE ON;\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:05:23 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE ENCRYPTION FOR DATABASE ON;",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE ENCRYPTION ALGORITHM 'AES256';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:13.045463",
                "end": "2024-12-06 17:05:51.148585",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE ENCRYPTION ALGORITHM 'AES256';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE ENCRYPTION ALGORITHM 'AES256'",
                "rc": 0,
                "start": "2024-12-06 17:05:38.103122",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:05:38 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE ENCRYPTION ALGORITHM 'AES256';\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:05:38 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE ENCRYPTION ALGORITHM 'AES256';",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE COMPRESSION ALGORITHM 'LOW' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:12.639678",
                "end": "2024-12-06 17:06:04.861788",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE COMPRESSION ALGORITHM 'LOW' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE COMPRESSION ALGORITHM 'LOW' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE",
                "rc": 0,
                "start": "2024-12-06 17:05:52.222110",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:05:52 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE COMPRESSION ALGORITHM 'LOW' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE;\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:05:52 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE COMPRESSION ALGORITHM 'LOW' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE;",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE RMAN OUTPUT TO KEEP FOR 100 DAYS;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:13.024567",
                "end": "2024-12-06 17:06:18.877280",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE RMAN OUTPUT TO KEEP FOR 100 DAYS;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE RMAN OUTPUT TO KEEP FOR 100 DAYS",
                "rc": 0,
                "start": "2024-12-06 17:06:05.852713",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:06:05 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE RMAN OUTPUT TO KEEP FOR 100 DAYS;\nnew RMAN configuration parameters are successfully stored\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:06:05 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE RMAN OUTPUT TO KEEP FOR 100 DAYS;",
                    "new RMAN configuration parameters are successfully stored",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE ARCHIVELOG DELETION POLICY TO APPLIED ON ALL STANDBY BACKED UP 1 TIMES TO 'SBT_TAPE';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:13.730031",
                "end": "2024-12-06 17:06:33.647918",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"CONFIGURE ARCHIVELOG DELETION POLICY TO APPLIED ON ALL STANDBY BACKED UP 1 TIMES TO 'SBT_TAPE';\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "CONFIGURE ARCHIVELOG DELETION POLICY TO APPLIED ON ALL STANDBY BACKED UP 1 TIMES TO 'SBT_TAPE'",
                "rc": 0,
                "start": "2024-12-06 17:06:19.917887",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:06:19 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nnew RMAN configuration parameters:\nCONFIGURE ARCHIVELOG DELETION POLICY TO APPLIED ON ALL STANDBY BACKED UP 1 TIMES TO 'SBT_TAPE';\nnew RMAN configuration parameters are successfully stored\nRMAN-08591: warning: invalid archived log deletion policy\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:06:19 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "new RMAN configuration parameters:",
                    "CONFIGURE ARCHIVELOG DELETION POLICY TO APPLIED ON ALL STANDBY BACKED UP 1 TIMES TO 'SBT_TAPE';",
                    "new RMAN configuration parameters are successfully stored",
                    "RMAN-08591: warning: invalid archived log deletion policy",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"show all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                "delta": "0:00:12.443286",
                "end": "2024-12-06 17:06:47.097781",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"show all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/rman target '\"c##rman_user/PassRMAN_2024#@OTCHPDUS_UKL as sysbackup\"' catalog c##rmanrco/Pk#3jvbds@RMANCAT_RMPD  \n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "show all",
                "rc": 0,
                "start": "2024-12-06 17:06:34.654495",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nRecovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:06:34 2024\nVersion 19.23.0.0.0\n\nCopyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.\n\nconnected to target database: OTCHPDUS (DBID=294426370)\nconnected to recovery catalog database\n\nRMAN> \nRMAN configuration parameters for database with db_unique_name OTCHPDUS_UKL are:\nCONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 32 DAYS;\nCONFIGURE BACKUP OPTIMIZATION ON;\nCONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE';\nCONFIGURE CONTROLFILE AUTOBACKUP ON;\nCONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE 'SBT_TAPE' TO '%F';\nCONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F'; # default\nCONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO COMPRESSED BACKUPSET;\nCONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO BACKUPSET; # default\nCONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default\nCONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default\nCONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default\nCONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default\nCONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS  'SBT_LIBRARY=/home/oracle/version1/RMANscripts/OPC/lib/libopc.so, ENV=(OPC_PFILE=/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora)';\nCONFIGURE MAXSETSIZE TO UNLIMITED; # default\nCONFIGURE ENCRYPTION FOR DATABASE ON;\nCONFIGURE ENCRYPTION ALGORITHM 'AES256';\nCONFIGURE COMPRESSION ALGORITHM 'LOW' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE;\nCONFIGURE RMAN OUTPUT TO KEEP FOR 100 DAYS;\nCONFIGURE ARCHIVELOG DELETION POLICY TO APPLIED ON ALL STANDBY BACKED UP 1 TIMES TO 'SBT_TAPE';\nCONFIGURE SNAPSHOT CONTROLFILE NAME TO '+RECOC1/OTCHPDUS_UKL/controlfile/snapcf_OTCHPDUS.f';\n\nRMAN> \n\nRecovery Manager complete.",
                "stdout_lines": [
                    "",
                    "Recovery Manager: Release 19.0.0.0.0 - Production on Fri Dec 6 17:06:34 2024",
                    "Version 19.23.0.0.0",
                    "",
                    "Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.",
                    "",
                    "connected to target database: OTCHPDUS (DBID=294426370)",
                    "connected to recovery catalog database",
                    "",
                    "RMAN> ",
                    "RMAN configuration parameters for database with db_unique_name OTCHPDUS_UKL are:",
                    "CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 32 DAYS;",
                    "CONFIGURE BACKUP OPTIMIZATION ON;",
                    "CONFIGURE DEFAULT DEVICE TYPE TO 'SBT_TAPE';",
                    "CONFIGURE CONTROLFILE AUTOBACKUP ON;",
                    "CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE 'SBT_TAPE' TO '%F';",
                    "CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F'; # default",
                    "CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO COMPRESSED BACKUPSET;",
                    "CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO BACKUPSET; # default",
                    "CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default",
                    "CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default",
                    "CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE SBT_TAPE TO 1; # default",
                    "CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default",
                    "CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS  'SBT_LIBRARY=/home/oracle/version1/RMANscripts/OPC/lib/libopc.so, ENV=(OPC_PFILE=/home/oracle/version1/RMANscripts/OPC/opcOTCHPDUS_STD.ora)';",
                    "CONFIGURE MAXSETSIZE TO UNLIMITED; # default",
                    "CONFIGURE ENCRYPTION FOR DATABASE ON;",
                    "CONFIGURE ENCRYPTION ALGORITHM 'AES256';",
                    "CONFIGURE COMPRESSION ALGORITHM 'LOW' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE;",
                    "CONFIGURE RMAN OUTPUT TO KEEP FOR 100 DAYS;",
                    "CONFIGURE ARCHIVELOG DELETION POLICY TO APPLIED ON ALL STANDBY BACKED UP 1 TIMES TO 'SBT_TAPE';",
                    "CONFIGURE SNAPSHOT CONTROLFILE NAME TO '+RECOC1/OTCHPDUS_UKL/controlfile/snapcf_OTCHPDUS.f';",
                    "",
                    "RMAN> ",
                    "",
                    "Recovery Manager complete."
                ]
            }
        ]
    }
}

TASK [pri_enable_backup : Get current timestamp _raw_params=date +%Y%m%d%H%M%S] ***
changed: [10.100.36.15]

TASK [pri_enable_backup : backup the existing crontab entries _raw_params=crontab -l] ***
changed: [10.100.36.15]

TASK [pri_enable_backup : Save crontab entries to a file content={{ cron_entries.stdout }}, dest=/home/oracle/crontab_entries_{{timestamp.stdout}}.txt, mode=384] ***
changed: [10.100.36.15]

TASK [pri_enable_backup : uncomment the cron jobs on node1 name={{ item.name }}, minute={{ item.minute }}, hour={{ item.hour }}, day={{ item.day }}, month={{ item.month }}, weekday={{ item.weekday }}, job={{ item.job }}, user=oracle, state=present] ***
changed: [10.100.36.15] => (item={'name': 'Level 0 backup for OTCHPDUS', 'minute': '00', 'hour': '03', 'day': '*', 'month': '*', 'weekday': '0', 'job': "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 0 8 >> /home/oracle/version1/RMANscripts/log/full_OTCHPDUS.log'", 'disabled': True})
changed: [10.100.36.15] => (item={'name': 'Level 1 backup for OTCHPDUS', 'minute': '00', 'hour': '03', 'day': '*', 'month': '*', 'weekday': '1-6', 'job': "flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 1 8 >> /home/oracle/version1/RMANscripts/log/incr_OTCHPDUS.log'", 'disabled': True})

TASK [pri_enable_backup : find the cronjobs for OTCHPDUS _raw_params=crontab -l | grep '{{ db_name }}'] ***
changed: [10.100.36.15]

TASK [pri_enable_backup : display the cronjobs for OTCHPDUS msg={{cron_out.stdout_lines}}] ***
ok: [10.100.36.15] => {
    "msg": [
        "#Ansible: Level 0 backup for OTCHPDUS",
        "00 03 * * 0 flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 0 8 >> /home/oracle/version1/RMANscripts/log/full_OTCHPDUS.log'",
        "#Ansible: Level 1 backup for OTCHPDUS",
        "00 03 * * 1-6 flock -w 300 -x /home/oracle/version1/RMANscripts/OTCHPDUS_backup.lock -c '/home/oracle/version1/RMANscripts/RMANBackupScript.sh OTCHPDUS 1 8 >> /home/oracle/version1/RMANscripts/log/incr_OTCHPDUS.log'"
    ]
}

PLAY [create required OCI secrets in the vault] ********************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.16.29]

TASK [pri_create_oci_secrets : retrieve the dbsnmp user vault id compartment_id={{ pri_compartment_id }}, display_name={{ pri_vault_display_name  }}, region={{ pri_region }}] ***
ok: [10.100.16.29]

TASK [pri_create_oci_secrets : display pri_vault_out var=pri_vault_out.vaults] ***
ok: [10.100.16.29] => {
    "pri_vault_out.vaults": [
        {
            "compartment_id": "ocid1.compartment.oc1..aaaaaaaalj2ziyzctjkbhcdszxnkhvf3ijaagfwzmrf7ffi5hvwejazyr2wq",
            "crypto_endpoint": "https://ertix7lcaaa2c-crypto.kms.uk-london-1.oraclecloud.com",
            "defined_tags": {
                "Hays-Tags": {
                    "AppName": "BENV",
                    "AppOwner": "OneTouch Support",
                    "BillableTo": "UK ITPS",
                    "Maintenance": "Tuesday Week 3",
                    "OnMaintenance": "True",
                    "TechnicalOwner": "CCOE"
                },
                "Oracle-Tags": {
                    "CreatedBy": "default/fawad.haider@version1.com",
                    "CreatedOn": "2024-07-08T14:53:22.237Z"
                }
            },
            "display_name": "otch-pd-exavmcl-admin-vault-01",
            "external_key_manager_metadata_summary": null,
            "freeform_tags": {},
            "id": "ocid1.vault.oc1.uk-london-1.ertix7lcaaa2c.abwgiljtv3rhk5jemg3h4weivtihzq3zuhqs4ypvu6fxkgmnuj6bw2xoitia",
            "lifecycle_state": "ACTIVE",
            "management_endpoint": "https://ertix7lcaaa2c-management.kms.uk-london-1.oraclecloud.com",
            "time_created": "2024-07-08T14:53:22.586000+00:00",
            "vault_type": "DEFAULT"
        }
    ]
}

TASK [pri_create_oci_secrets : display pri_vault_out id var=pri_vault_out.vaults[0].id] ***
ok: [10.100.16.29] => {
    "pri_vault_out.vaults[0].id": "ocid1.vault.oc1.uk-london-1.ertix7lcaaa2c.abwgiljtv3rhk5jemg3h4weivtihzq3zuhqs4ypvu6fxkgmnuj6bw2xoitia"
}

TASK [pri_create_oci_secrets : set the primary dbssnmp vault id pri_vault_id={{ pri_vault_out.vaults[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_create_oci_secrets : set the admin plain text password pri_admin_password={{ admin_password }}] ***
ok: [10.100.16.29]

TASK [pri_create_oci_secrets : convert the plain text password to BASE64 pri_admin_base64_password={{ pri_admin_password | b64encode }}] ***
ok: [10.100.16.29]

TASK [pri_create_oci_secrets : display pri_vault_out management_endpoint var=pri_vault_out.vaults[0].management_endpoint] ***
ok: [10.100.16.29] => {
    "pri_vault_out.vaults[0].management_endpoint": "https://ertix7lcaaa2c-management.kms.uk-london-1.oraclecloud.com"
}

TASK [pri_create_oci_secrets : set the primary vault management_endpoint pri_management_endpoint={{ pri_vault_out.vaults[0].management_endpoint }}] ***
ok: [10.100.16.29]

TASK [pri_create_oci_secrets : retrieve the master encryption key compartment_id={{ pri_compartment_id }}, display_name={{ pri_master_encryption_key }}, region={{ pri_region }}, service_endpoint={{ pri_management_endpoint }}] ***
ok: [10.100.16.29]

TASK [pri_create_oci_secrets : display pri_mes_out var=pri_mes_out] ************
ok: [10.100.16.29] => {
    "pri_mes_out": {
        "changed": false,
        "failed": false,
        "keys": [
            {
                "algorithm": "AES",
                "compartment_id": "ocid1.compartment.oc1..aaaaaaaalj2ziyzctjkbhcdszxnkhvf3ijaagfwzmrf7ffi5hvwejazyr2wq",
                "defined_tags": {},
                "display_name": "otch-pd-exavmcl-admin-mes-01",
                "external_key_reference_details": null,
                "freeform_tags": {},
                "id": "ocid1.key.oc1.uk-london-1.ertix7lcaaa2c.abwgiljsihogdoxfjstknbzimbt6dsvztuimahqk6blvjrroo6znec2hjz7a",
                "is_auto_rotation_enabled": false,
                "lifecycle_state": "ENABLED",
                "protection_mode": "SOFTWARE",
                "time_created": "2024-07-08T15:19:16.373000+00:00",
                "vault_id": "ocid1.vault.oc1.uk-london-1.ertix7lcaaa2c.abwgiljtv3rhk5jemg3h4weivtihzq3zuhqs4ypvu6fxkgmnuj6bw2xoitia"
            }
        ]
    }
}

TASK [pri_create_oci_secrets : Display the type of pri_mes_out msg={{ pri_mes_out | type_debug }}] ***
ok: [10.100.16.29] => {
    "msg": "dict"
}

TASK [pri_create_oci_secrets : Display the type of pri_mes_out.keys msg={{ pri_mes_out.keys | type_debug }}] ***
ok: [10.100.16.29] => {
    "msg": "builtin_function_or_method"
}

TASK [pri_create_oci_secrets : Display the keys section msg={{ pri_mes_out['keys'] }}] ***
ok: [10.100.16.29] => {
    "msg": [
        {
            "algorithm": "AES",
            "compartment_id": "ocid1.compartment.oc1..aaaaaaaalj2ziyzctjkbhcdszxnkhvf3ijaagfwzmrf7ffi5hvwejazyr2wq",
            "defined_tags": {},
            "display_name": "otch-pd-exavmcl-admin-mes-01",
            "external_key_reference_details": null,
            "freeform_tags": {},
            "id": "ocid1.key.oc1.uk-london-1.ertix7lcaaa2c.abwgiljsihogdoxfjstknbzimbt6dsvztuimahqk6blvjrroo6znec2hjz7a",
            "is_auto_rotation_enabled": false,
            "lifecycle_state": "ENABLED",
            "protection_mode": "SOFTWARE",
            "time_created": "2024-07-08T15:19:16.373000+00:00",
            "vault_id": "ocid1.vault.oc1.uk-london-1.ertix7lcaaa2c.abwgiljtv3rhk5jemg3h4weivtihzq3zuhqs4ypvu6fxkgmnuj6bw2xoitia"
        }
    ]
}

TASK [pri_create_oci_secrets : Display the id from the keys section msg={{ pri_mes_out['keys'][0]['id'] }}] ***
ok: [10.100.16.29] => {
    "msg": "ocid1.key.oc1.uk-london-1.ertix7lcaaa2c.abwgiljsihogdoxfjstknbzimbt6dsvztuimahqk6blvjrroo6znec2hjz7a"
}

TASK [pri_create_oci_secrets : set master encryption key id pri_mes_id={{ pri_mes_out['keys'][0]['id'] }}] ***
ok: [10.100.16.29]

TASK [pri_create_oci_secrets : Create secret compartment_id={{ pri_compartment_id }}, secret_name={{ pri_db_mon_user_secret_name }}, vault_id={{ pri_vault_id }}, key_id={{ pri_mes_id }}, secret_content={'content_type': 'BASE64', 'content': '{{ pri_admin_base64_password }}'}] ***
ok: [10.100.16.29]

TASK [pri_create_oci_secrets : Display created secret details var=created_secret] ***
ok: [10.100.16.29] => {
    "created_secret": {
        "changed": false,
        "failed": false,
        "secret": {
            "compartment_id": "ocid1.compartment.oc1..aaaaaaaalj2ziyzctjkbhcdszxnkhvf3ijaagfwzmrf7ffi5hvwejazyr2wq",
            "current_version_number": 1,
            "defined_tags": {
                "Hays-Tags": {
                    "AppName": "OneTouch Exa Prod",
                    "AppOwner": "Front Office",
                    "BillableTo": "UK ITPS",
                    "Environment": "Prod",
                    "TechnicalOwner": "Front Office"
                },
                "Oracle-Tags": {
                    "CreatedBy": "default/ansibleadmin",
                    "CreatedOn": "2024-10-15T14:45:02.734Z"
                }
            },
            "description": null,
            "freeform_tags": {},
            "id": "ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a",
            "is_auto_generation_enabled": false,
            "key_id": "ocid1.key.oc1.uk-london-1.ertix7lcaaa2c.abwgiljsihogdoxfjstknbzimbt6dsvztuimahqk6blvjrroo6znec2hjz7a",
            "last_rotation_time": null,
            "lifecycle_details": null,
            "lifecycle_state": "ACTIVE",
            "metadata": null,
            "next_rotation_time": null,
            "rotation_config": null,
            "rotation_status": "NOT_ENABLED",
            "secret_generation_context": null,
            "secret_name": "foa-ukl1-pd-exavmcl-01-us-dbsnmp",
            "secret_rules": null,
            "time_created": "2024-10-15T14:45:02.682000+00:00",
            "time_of_current_version_expiry": null,
            "time_of_deletion": null,
            "vault_id": "ocid1.vault.oc1.uk-london-1.ertix7lcaaa2c.abwgiljtv3rhk5jemg3h4weivtihzq3zuhqs4ypvu6fxkgmnuj6bw2xoitia"
        }
    }
}

PLAY [grant the required permission dbsnmp to enable OCI database monitoring] ***

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.15]

TASK [pri_db_monitoring_prereqs : grant the required permission to dbsnmp at cdb level to enable OCI DB monitoring _raw_params=.  "/home/oracle/{{db_name}}.env"
echo -e "SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\n {{item}};" | {{ pri_oracle_home }}/bin/sqlplus -s / as sysdba
] ***
changed: [10.100.36.15] => (item=GRANT CREATE PROCEDURE to dbsnmp container=all)
changed: [10.100.36.15] => (item=GRANT SELECT ANY DICTIONARY, SELECT_CATALOG_ROLE to dbsnmp container=all)
changed: [10.100.36.15] => (item=GRANT ALTER SYSTEM to dbsnmp container=all)
changed: [10.100.36.15] => (item=GRANT ADVISOR to dbsnmp container=all)
changed: [10.100.36.15] => (item=GRANT EXECUTE ON DBMS_WORKLOAD_REPOSITORY to dbsnmp container=all)
changed: [10.100.36.15] => (item=GRANT SYSDG, SYSDBA, SYSOPER to dbsnmp container=all)

TASK [pri_db_monitoring_prereqs : display cdb_per var=cdb_per] *****************
ok: [10.100.36.15] => {
    "cdb_per": {
        "changed": true,
        "msg": "All items completed",
        "results": [
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT CREATE PROCEDURE to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                "delta": "0:00:00.334873",
                "end": "2024-12-06 17:07:06.071765",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT CREATE PROCEDURE to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "GRANT CREATE PROCEDURE to dbsnmp container=all",
                "rc": 0,
                "start": "2024-12-06 17:07:05.736892",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nGrant succeeded.",
                "stdout_lines": [
                    "",
                    "Grant succeeded."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT SELECT ANY DICTIONARY, SELECT_CATALOG_ROLE to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                "delta": "0:00:00.368845",
                "end": "2024-12-06 17:07:07.358741",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT SELECT ANY DICTIONARY, SELECT_CATALOG_ROLE to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "GRANT SELECT ANY DICTIONARY, SELECT_CATALOG_ROLE to dbsnmp container=all",
                "rc": 0,
                "start": "2024-12-06 17:07:06.989896",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nGrant succeeded.",
                "stdout_lines": [
                    "",
                    "Grant succeeded."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT ALTER SYSTEM to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                "delta": "0:00:00.358220",
                "end": "2024-12-06 17:07:08.676879",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT ALTER SYSTEM to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "GRANT ALTER SYSTEM to dbsnmp container=all",
                "rc": 0,
                "start": "2024-12-06 17:07:08.318659",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nGrant succeeded.",
                "stdout_lines": [
                    "",
                    "Grant succeeded."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT ADVISOR to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                "delta": "0:00:00.346423",
                "end": "2024-12-06 17:07:10.138776",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT ADVISOR to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "GRANT ADVISOR to dbsnmp container=all",
                "rc": 0,
                "start": "2024-12-06 17:07:09.792353",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nGrant succeeded.",
                "stdout_lines": [
                    "",
                    "Grant succeeded."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT EXECUTE ON DBMS_WORKLOAD_REPOSITORY to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                "delta": "0:00:00.486690",
                "end": "2024-12-06 17:07:11.569842",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT EXECUTE ON DBMS_WORKLOAD_REPOSITORY to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "GRANT EXECUTE ON DBMS_WORKLOAD_REPOSITORY to dbsnmp container=all",
                "rc": 0,
                "start": "2024-12-06 17:07:11.083152",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nGrant succeeded.",
                "stdout_lines": [
                    "",
                    "Grant succeeded."
                ]
            },
            {
                "ansible_loop_var": "item",
                "changed": true,
                "cmd": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT SYSDG, SYSDBA, SYSOPER to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                "delta": "0:00:03.591204",
                "end": "2024-12-06 17:07:16.159865",
                "failed": false,
                "invocation": {
                    "module_args": {
                        "_raw_params": ".  \"/home/oracle/OTCHPDUS.env\"\necho -e \"SET PAGESIZE 0 FEEDBACK ON VERIFY OFF HEADING OFF ECHO OFF\\n GRANT SYSDG, SYSDBA, SYSOPER to dbsnmp container=all;\" | /u02/app/oracle/product/19.0.0.0/dbhome_2/bin/sqlplus -s / as sysdba\n",
                        "_uses_shell": true,
                        "argv": null,
                        "chdir": null,
                        "creates": null,
                        "executable": null,
                        "removes": null,
                        "stdin": null,
                        "stdin_add_newline": true,
                        "strip_empty_ends": true,
                        "warn": true
                    }
                },
                "item": "GRANT SYSDG, SYSDBA, SYSOPER to dbsnmp container=all",
                "rc": 0,
                "start": "2024-12-06 17:07:12.568661",
                "stderr": "",
                "stderr_lines": [],
                "stdout": "\nGrant succeeded.",
                "stdout_lines": [
                    "",
                    "Grant succeeded."
                ]
            }
        ]
    }
}

PLAY [enable OCI database monitoring] ******************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.16.29]

TASK [pri_db_monitoring : retrieve the dbsnmp user vault id compartment_id={{ pri_compartment_id }}, display_name={{ pri_vault_display_name  }}, region={{ pri_region }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : display pri_vault_out id var=pri_vault_out.vaults[0].id] ***
ok: [10.100.16.29] => {
    "pri_vault_out.vaults[0].id": "ocid1.vault.oc1.uk-london-1.ertix7lcaaa2c.abwgiljtv3rhk5jemg3h4weivtihzq3zuhqs4ypvu6fxkgmnuj6bw2xoitia"
}

TASK [pri_db_monitoring : set the primary dbssnmp vault id pri_vault_id={{ pri_vault_out.vaults[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : retrieve the dbsnmp secret id vault_id={{ pri_vault_id }}, compartment_id={{ pri_compartment_id }}, name={{ pri_db_mon_user_secret_name }}, lifecycle_state=ACTIVE] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : display pri_db_mon_user_secret_out id var=pri_db_mon_user_secret_out.secrets[0].id] ***
ok: [10.100.16.29] => {
    "pri_db_mon_user_secret_out.secrets[0].id": "ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a"
}

TASK [pri_db_monitoring : set the primary dbssnmp secret id pri_db_mon_user_secret_id={{ pri_db_mon_user_secret_out.secrets[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : retrieve the primary database management  private_end_point_id name={{ pri_db_management_private_endpoint_name }}, compartment_id={{ pri_compartment_id }}, lifecycle_state=ACTIVE] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : display pri_db_management_end_point var=pri_db_management_private_end_point_out.db_management_private_endpoints[0].id] ***
ok: [10.100.16.29] => {
    "pri_db_management_private_end_point_out.db_management_private_endpoints[0].id": "ocid1.dbmgmtprivateendpoint.oc1.uk-london-1.amaaaaaapgtet6qakqyo5bhvivjadynetio5gpyjmehya56ysyg3jrrjpj3a"
}

TASK [pri_db_monitoring : set the primary dbssnmp secret id pri_db_management_private_endpoint_id={{ pri_db_management_private_end_point_out.db_management_private_endpoints[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : get the primary vm_cluster_ocid from the cluster display name lifecycle_state=AVAILABLE, compartment_id={{ pri_compartment_id }}, display_name={{ pri_vm_cluster_display_name }}, region={{ pri_region }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : display pri_cluster_out var=pri_cluster_out.cloud_vm_clusters[0].id] ***
ok: [10.100.16.29] => {
    "pri_cluster_out.cloud_vm_clusters[0].id": "ocid1.cloudvmcluster.oc1.uk-london-1.anwgiljtpgtet6qa6ijohnizej4w2sk3gw7cohbeolvm7uc225shoycsjdzq"
}

TASK [pri_db_monitoring : set the primary vm cluster id pri_vm_cluster_id={{ pri_cluster_out.cloud_vm_clusters[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : get the primary db_home_id vm_cluster_id={{ pri_vm_cluster_id }}, compartment_id={{ pri_compartment_id }}, lifecycle_state=AVAILABLE, display_name={{ pri_db_home_display_name }}, region={{ pri_region }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : display pri_db_home_out var=pri_db_home_out.db_homes[0].id] ***
ok: [10.100.16.29] => {
    "pri_db_home_out.db_homes[0].id": "ocid1.dbhome.oc1.uk-london-1.anwgiljtwli4jtqalrdls4sl5w4p4fnkjeszey2ijjdxjpqlmthocb44llia"
}

TASK [pri_db_monitoring : set the primary db_home_id pri_db_home_id={{ pri_db_home_out.db_homes[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : get the primary database ocid db_home_id={{ pri_db_home_id }}, db_name={{ db_name }}, lifecycle_state=AVAILABLE, compartment_id={{ pri_compartment_id }}, region={{ pri_region }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : display pri_db_id var=pri_db_id_out.databases[0].id] ***
ok: [10.100.16.29] => {
    "pri_db_id_out.databases[0].id": "ocid1.database.oc1.uk-london-1.anwgiljtpgtet6qa747mfh66c7q3ch7fki3tih467ncgq3id33j4azelytxq"
}

TASK [pri_db_monitoring : set the pri_db_id pri_db_id={{ pri_db_id_out.databases[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : retrieve the DBMgmt_Resource_Policy policy id name={{ pri_dbmgmt_res_policy }}, compartment_id={{ pri_compartment_id }}, region={{ pri_region }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : set the DBMgmt_Resource_Policy policy id pri_dbmgmt_res_policy_id={{ pri_dbmgmt_res_policy_out.policies[0].id }}, pri_dbmgmt_res_current_statements={{ pri_dbmgmt_res_policy_out.policies[0].statements }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : define the new statement pri_dbmgmt_res_new_statement=Allow any-user to read secret-family in compartment '{{ pri_compartment_name }}' where ALL {target.secret.id = '{{ pri_db_mon_user_secret_id }}',request.principal.type = 'dbmgmtmanageddatabase'}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : add new statement to the exisitng statements pri_dbmgmt_res_updated_statements={{ pri_dbmgmt_res_current_statements + [ pri_dbmgmt_res_new_statement ] }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : display the exisiting policy statements for DBMgmt_Resource_Policy var=pri_dbmgmt_res_current_statements] ***
ok: [10.100.16.29] => {
    "pri_dbmgmt_res_current_statements": [
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qag5zalqcf72o3e4fqxbyd4k52zuhz3cljktgodeu54u6a',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qal4naeee3z4xjvrb7vpxghxqkl425g77fcwoiesx3zviq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljqxg2gx7bzuj5l5egibzvi7akoatx5lbm6dmrxns6pq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qal4naeee3z4xjvrb7vpxghxqkl425g77fcwoiesx3zviq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qalfd2n466ocdfanutpnsbpcha375ndhlieybecvhrfhmq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa3ewn6nisbludjy6b5wfzrxa3d6jqkdf7ux2wspctezcq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qakvsd7lkiomoqclj67f4xeqc4ki24lat3ocbgodnephgq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa2y42skfkxgoilybv6u3txdqqmcrn2jfwsbcz7rhdoyza',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qat3xjbztxycw6vhj7ud4obutv4ua2ep66hdtz5zqz5zba',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa5b4memmhoj2di5aemlfz7b7zuqak7wmdh3xxzbxuyckq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qankbxcctstoznv7ci3qlfy3mpxnbx7lc5hbfel7gt4zha',request.principal.type = 'dbmgmtmanageddatabase'}"
    ]
}

TASK [pri_db_monitoring : display the new policy statement for DBMgmt_Resource_Policy var=pri_dbmgmt_res_new_statement] ***
ok: [10.100.16.29] => {
    "pri_dbmgmt_res_new_statement": "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a',request.principal.type = 'dbmgmtmanageddatabase'}"
}

TASK [pri_db_monitoring : display the combined policy statements DBMgmt_Resource_Policy var=pri_dbmgmt_res_updated_statements] ***
ok: [10.100.16.29] => {
    "pri_dbmgmt_res_updated_statements": [
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qag5zalqcf72o3e4fqxbyd4k52zuhz3cljktgodeu54u6a',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qal4naeee3z4xjvrb7vpxghxqkl425g77fcwoiesx3zviq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljqxg2gx7bzuj5l5egibzvi7akoatx5lbm6dmrxns6pq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qal4naeee3z4xjvrb7vpxghxqkl425g77fcwoiesx3zviq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qalfd2n466ocdfanutpnsbpcha375ndhlieybecvhrfhmq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa3ewn6nisbludjy6b5wfzrxa3d6jqkdf7ux2wspctezcq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qakvsd7lkiomoqclj67f4xeqc4ki24lat3ocbgodnephgq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa2y42skfkxgoilybv6u3txdqqmcrn2jfwsbcz7rhdoyza',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qat3xjbztxycw6vhj7ud4obutv4ua2ep66hdtz5zqz5zba',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa5b4memmhoj2di5aemlfz7b7zuqak7wmdh3xxzbxuyckq',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qankbxcctstoznv7ci3qlfy3mpxnbx7lc5hbfel7gt4zha',request.principal.type = 'dbmgmtmanageddatabase'}",
        "Allow any-user to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where ALL {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a',request.principal.type = 'dbmgmtmanageddatabase'}"
    ]
}

TASK [pri_db_monitoring : update the DBMgmt_Resource_Policy policy policy_id={{ pri_dbmgmt_res_policy_id }}, statements={{ pri_dbmgmt_res_updated_statements }}] ***
changed: [10.100.16.29]

TASK [pri_db_monitoring : retrieve the DBMgmt_Service_Policy policy id name={{ pri_dbmgmt_serv_policy }}, compartment_id={{ pri_compartment_id }}, region={{ pri_region }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : set the DBMgmt_Service_Policy policy id pri_dbmgmt_serv_policy_id={{ pri_dbmgmt_serv_policy_out.policies[0].id }}, pri_dbmgmt_serv_current_statements={{ pri_dbmgmt_serv_policy_out.policies[0].statements }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : define the new statement pri_dbmgmt_serv_new_statement=Allow service dpd to read secret-family in compartment '{{ pri_compartment_name }}' where any {target.secret.id = '{{ pri_db_mon_user_secret_id }}'}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : add new statement to the exisitng statements pri_dbmgmt_serv_updated_statements={{ pri_dbmgmt_serv_current_statements + [ pri_dbmgmt_serv_new_statement ] }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : display the exisiting policy statements for DBMgmt_Service_Policy var=pri_dbmgmt_serv_current_statements] ***
ok: [10.100.16.29] => {
    "pri_dbmgmt_serv_current_statements": [
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qal4naeee3z4xjvrb7vpxghxqkl425g77fcwoiesx3zviq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qag5zalqcf72o3e4fqxbyd4k52zuhz3cljktgodeu54u6a',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljqxg2gx7bzuj5l5egibzvi7akoatx5lbm6dmrxns6pq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qal4naeee3z4xjvrb7vpxghxqkl425g77fcwoiesx3zviq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qalfd2n466ocdfanutpnsbpcha375ndhlieybecvhrfhmq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa3ewn6nisbludjy6b5wfzrxa3d6jqkdf7ux2wspctezcq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qakvsd7lkiomoqclj67f4xeqc4ki24lat3ocbgodnephgq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa2y42skfkxgoilybv6u3txdqqmcrn2jfwsbcz7rhdoyza',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qat3xjbztxycw6vhj7ud4obutv4ua2ep66hdtz5zqz5zba',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa5b4memmhoj2di5aemlfz7b7zuqak7wmdh3xxzbxuyckq'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qankbxcctstoznv7ci3qlfy3mpxnbx7lc5hbfel7gt4zha'}"
    ]
}

TASK [pri_db_monitoring : display the new policy statement for DBMgmt_Service_Policy var=pri_dbmgmt_serv_new_statement] ***
ok: [10.100.16.29] => {
    "pri_dbmgmt_serv_new_statement": "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a'}"
}

TASK [pri_db_monitoring : display the combined policy statements DBMgmt_Service_Policy var=pri_dbmgmt_serv_updated_statements] ***
ok: [10.100.16.29] => {
    "pri_dbmgmt_serv_updated_statements": [
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qal4naeee3z4xjvrb7vpxghxqkl425g77fcwoiesx3zviq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qag5zalqcf72o3e4fqxbyd4k52zuhz3cljktgodeu54u6a',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljqxg2gx7bzuj5l5egibzvi7akoatx5lbm6dmrxns6pq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qal4naeee3z4xjvrb7vpxghxqkl425g77fcwoiesx3zviq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qalfd2n466ocdfanutpnsbpcha375ndhlieybecvhrfhmq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa3ewn6nisbludjy6b5wfzrxa3d6jqkdf7ux2wspctezcq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qakvsd7lkiomoqclj67f4xeqc4ki24lat3ocbgodnephgq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaakoj2xthn22as35buqq5z7dbdlkggfl7w6fgrxmf5euq',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qaljoqczazlxmvyexgtaulqdan6vdsusrpju5rilsffxxa',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa2y42skfkxgoilybv6u3txdqqmcrn2jfwsbcz7rhdoyza',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qat3xjbztxycw6vhj7ud4obutv4ua2ep66hdtz5zqz5zba',target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qamhyyklqvsirauzcefgffdpoxm4nrlzx5xdpfqe5ep25q'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qa5b4memmhoj2di5aemlfz7b7zuqak7wmdh3xxzbxuyckq'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qankbxcctstoznv7ci3qlfy3mpxnbx7lc5hbfel7gt4zha'}",
        "Allow service dpd to read secret-family in compartment 'otch-pd-exavmcl-cmp-01' where any {target.secret.id = 'ocid1.vaultsecret.oc1.uk-london-1.amaaaaaapgtet6qanup3d67ov6qkfcj4ezpcg3ukigvlbtceivch277jzg2a'}"
    ]
}

TASK [pri_db_monitoring : update the DBMgmt_Service_Policy policy policy_id={{ pri_dbmgmt_serv_policy_id }}, statements={{ pri_dbmgmt_serv_updated_statements }}] ***
changed: [10.100.16.29]

TASK [pri_db_monitoring : Perform action enable_database_management on "OTCHPDUS" database credential_details={'user_name': '{{ db_mon_user }}', 'password_secret_id': '{{ pri_db_mon_user_secret_id }}'}, private_end_point_id={{ pri_db_management_private_endpoint_id }}, service_name={{ pri_cdb_mon_service_name }}, database_id={{ pri_db_id }}, action=enable_database_management, management_type=ADVANCED, protocol=TCP, port=1521, role=NORMAL] ***
changed: [10.100.16.29]

TASK [pri_db_monitoring : display cdb_database_management_out var=cdb_database_management_out.database] ***
ok: [10.100.16.29] => {
    "cdb_database_management_out.database": {
        "character_set": "AL32UTF8",
        "compartment_id": "ocid1.compartment.oc1..aaaaaaaalj2ziyzctjkbhcdszxnkhvf3ijaagfwzmrf7ffi5hvwejazyr2wq",
        "connection_strings": {
            "all_connection_strings": {
                "cdbDefault": "foaukl1pddb-4kxck-scan.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com:1521/OTCHPDUS_UKL.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com",
                "cdbIpDefault": "(DESCRIPTION=(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(LOAD_BALANCE=on)(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.57)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.19)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.56)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=OTCHPDUS_UKL.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com)))"
            },
            "cdb_default": "foaukl1pddb-4kxck-scan.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com:1521/OTCHPDUS_UKL.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com",
            "cdb_ip_default": "(DESCRIPTION=(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(LOAD_BALANCE=on)(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.57)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.19)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.56)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=OTCHPDUS_UKL.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com)))"
        },
        "database_management_config": {
            "management_status": "ENABLED",
            "management_type": "ADVANCED"
        },
        "database_software_image_id": "ocid1.databasesoftwareimage.oc1.uk-london-1.anwgiljtpgtet6qayey5rkocdwcu6kujvauqsboemjk6d7njvye25vzuirva",
        "db_backup_config": null,
        "db_home_id": "ocid1.dbhome.oc1.uk-london-1.anwgiljtwli4jtqalrdls4sl5w4p4fnkjeszey2ijjdxjpqlmthocb44llia",
        "db_name": "OTCHPDUS",
        "db_system_id": null,
        "db_unique_name": "OTCHPDUS_UKL",
        "db_workload": "OLTP",
        "defined_tags": {
            "Hays-Tags": {
                "AppName": "OneTouch Exa Prod",
                "AppOwner": "Front Office",
                "BillableTo": "UK ITPS",
                "Environment": "Prod",
                "TechnicalOwner": "Front Office"
            },
            "Oracle-Tags": {
                "CreatedBy": "default/ansibleadmin",
                "CreatedOn": "2024-12-06T16:27:31.160Z"
            }
        },
        "freeform_tags": {},
        "id": "ocid1.database.oc1.uk-london-1.anwgiljtpgtet6qa747mfh66c7q3ch7fki3tih467ncgq3id33j4azelytxq",
        "is_cdb": true,
        "key_store_id": null,
        "key_store_wallet_name": null,
        "kms_key_id": null,
        "kms_key_version_id": null,
        "last_backup_duration_in_seconds": null,
        "last_backup_timestamp": null,
        "last_failed_backup_timestamp": null,
        "lifecycle_details": null,
        "lifecycle_state": "AVAILABLE",
        "ncharacter_set": "UTF8",
        "pdb_name": "USPD",
        "sid_prefix": "OTCHPDUS",
        "source_database_point_in_time_recovery_timestamp": null,
        "time_created": "2024-12-06T16:27:31.190000+00:00",
        "vault_id": null,
        "vm_cluster_id": "ocid1.cloudvmcluster.oc1.uk-london-1.anwgiljtpgtet6qa6ijohnizej4w2sk3gw7cohbeolvm7uc225shoycsjdzq"
    }
}

TASK [pri_db_monitoring : retrieve the pdb id database_id={{ pri_db_id }}, pdb_name={{ pdb_name }}, lifecycle_state=AVAILABLE] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : display pdb_id_out var=pdb_id_out.pluggable_databases[0].id] ***
ok: [10.100.16.29] => {
    "pdb_id_out.pluggable_databases[0].id": "ocid1.pluggabledatabase.oc1.uk-london-1.anwgiljtpgtet6qabii7jnvctzs4c6o2ryeutb3fzg7fgdlow2h7vlpxmulq"
}

TASK [pri_db_monitoring : set the pdb_id pdb_id={{ pdb_id_out.pluggable_databases[0].id }}] ***
ok: [10.100.16.29]

TASK [pri_db_monitoring : Perform action enable_pluggable_database_management on "USPD" database credential_details={'user_name': '{{ db_mon_user }}', 'password_secret_id': '{{ pri_db_mon_user_secret_id }}'}, private_end_point_id={{ pri_db_management_private_endpoint_id }}, service_name={{ pri_pdb_mon_service_name }}, pluggable_database_id={{ pdb_id }}, action=enable_pluggable_database_management, protocol=TCP, port=1521, role=NORMAL] ***
changed: [10.100.16.29]

TASK [pri_db_monitoring : display pdb_database_management_out var=pdb_database_management_out.pluggable_database] ***
ok: [10.100.16.29] => {
    "pdb_database_management_out.pluggable_database": {
        "compartment_id": "ocid1.compartment.oc1..aaaaaaaalj2ziyzctjkbhcdszxnkhvf3ijaagfwzmrf7ffi5hvwejazyr2wq",
        "connection_strings": {
            "all_connection_strings": {
                "pdbDefault": "foaukl1pddb-4kxck-scan.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com:1521/OTCHPDUS_USPD.paas.oracle.com",
                "pdbIpDefault": "(DESCRIPTION=(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(LOAD_BALANCE=on)(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.57)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.19)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.56)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=OTCHPDUS_USPD.paas.oracle.com)))"
            },
            "pdb_default": "foaukl1pddb-4kxck-scan.otchukl1pdexcl.otchukl1pdvcn01.oraclevcn.com:1521/OTCHPDUS_USPD.paas.oracle.com",
            "pdb_ip_default": "(DESCRIPTION=(CONNECT_TIMEOUT=5)(TRANSPORT_CONNECT_TIMEOUT=3)(RETRY_COUNT=3)(ADDRESS_LIST=(LOAD_BALANCE=on)(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.57)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.19)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=10.100.36.56)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=OTCHPDUS_USPD.paas.oracle.com)))"
        },
        "container_database_id": "ocid1.database.oc1.uk-london-1.anwgiljtpgtet6qa747mfh66c7q3ch7fki3tih467ncgq3id33j4azelytxq",
        "defined_tags": {},
        "freeform_tags": {},
        "id": "ocid1.pluggabledatabase.oc1.uk-london-1.anwgiljtpgtet6qabii7jnvctzs4c6o2ryeutb3fzg7fgdlow2h7vlpxmulq",
        "is_restricted": null,
        "lifecycle_details": null,
        "lifecycle_state": "AVAILABLE",
        "open_mode": "READ_WRITE",
        "pdb_name": "USPD",
        "pdb_node_level_details": [
            {
                "node_name": "foaukl1pddb-4kxck2",
                "open_mode": "READ_WRITE"
            },
            {
                "node_name": "foaukl1pddb-4kxck1",
                "open_mode": "READ_WRITE"
            }
        ],
        "pluggable_database_management_config": {
            "management_status": "ENABLED"
        },
        "refreshable_clone_config": null,
        "time_created": "2024-12-06T16:53:37.020000+00:00"
    }
}

PLAY [disable the bkup_api_archlogs_job] ***************************************

TASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ****************
ok: [10.100.36.15]

TASK [pri_disable_bkup_api_archlogs_job : generate a config file from the template for OTCHPDUS src={{ item.src }}, dest={{ item.dest }}, owner=oracle, group=oinstall, mode=u=rw,g=r,o=r] ***
changed: [10.100.36.15] => (item={'src': 'arch_cfg.j2', 'dest': '/tmp/OTCHPDUS_arch_cfg'})

TASK [pri_disable_bkup_api_archlogs_job : display the new OTCHPDUS_arch_cfg file status msg={{ arch_out }}] ***
ok: [10.100.36.15] => {
    "msg": {
        "changed": true,
        "msg": "All items completed",
        "results": [
            {
                "ansible_loop_var": "item",
                "changed": true,
                "checksum": "9286d8af3b330a4ac361bdf0abcc14a32890d7da",
                "dest": "/tmp/OTCHPDUS_arch_cfg",
                "diff": [],
                "failed": false,
                "gid": 1001,
                "group": "oinstall",
                "invocation": {
                    "module_args": {
                        "_original_basename": "arch_cfg.j2",
                        "attributes": null,
                        "backup": false,
                        "checksum": "9286d8af3b330a4ac361bdf0abcc14a32890d7da",
                        "content": null,
                        "delimiter": null,
                        "dest": "/tmp/OTCHPDUS_arch_cfg",
                        "directory_mode": null,
                        "follow": false,
                        "force": true,
                        "group": "oinstall",
                        "local_follow": null,
                        "mode": "u=rw,g=r,o=r",
                        "owner": "oracle",
                        "regexp": null,
                        "remote_src": null,
                        "selevel": null,
                        "serole": null,
                        "setype": null,
                        "seuser": null,
                        "src": "/home/ansibleadmin/.ansible/tmp/ansible-tmp-1733505145.7020206-885103-28542003948556/source",
                        "unsafe_writes": false,
                        "validate": null
                    }
                },
                "item": {
                    "dest": "/tmp/OTCHPDUS_arch_cfg",
                    "src": "arch_cfg.j2"
                },
                "md5sum": "41e9419368b56cc2eb56d2c1815ea84a",
                "mode": "0644",
                "owner": "oracle",
                "size": 1528,
                "src": "/home/ansibleadmin/.ansible/tmp/ansible-tmp-1733505145.7020206-885103-28542003948556/source",
                "state": "file",
                "uid": 1001
            }
        ]
    }
}

TASK [pri_disable_bkup_api_archlogs_job : disable the bkup_archlogs using the config file _raw_params=/var/opt/oracle/bkup_api/bkup_api set config --file=/tmp/{{db_name}}_arch_cfg --dbname={{db_name}}
/var/opt/oracle/bkup_api/bkup_api configure_status --dbname={{db_name}}
] ***
changed: [10.100.36.15]

TASK [pri_disable_bkup_api_archlogs_job : display the status of the configuration update msg={{ status_out.stdout_lines }}] ***
ok: [10.100.36.15] => {
    "msg": [
        "DBaaS Backup API V1.5 @2024 Multi-Oracle home",
        "-> Action : set_config",
        "-> WARNING: bkup_api set_config is deprecated! Use 'dbaascli' to perform this operation. Check \"dbaascli database backup --help\" for more details.",
        "-> logfile: /var/opt/oracle/log/OTCHPDUS/bkup_api_log/bkup_api_d7cd2d42_20241206171228.591103.log",
        "DBAAS CLI version 24.4.1.0.0",
        "Executing command database backup --configure --dbname OTCHPDUS --configFile /tmp/OTCHPDUS_arch_cfg",
        "Session log: /var/opt/oracle/log/OTCHPDUS/database/backup/dbaastools_2024-12-06_05-12-32-PM_396372.log",
        "logfile:/var/opt/oracle/log/dtrs/dcs-dtrs.0.*.log",
        "UUID 2d367d09-d1f3-4451-a7fc-823e8edf6105 for this backup configuration",
        "",
        "",
        "dbaascli execution completed",
        "",
        "DBaaS Backup API V1.5 @2024 Multi-Oracle home",
        "WARNING: Option will be decommisioned.",
        "-> Action : configure_status",
        "-> logfile: /var/opt/oracle/log/OTCHPDUS/bkup_api_log/bkup_api_cef062f9_20241206171237.539775.log",
        "*Last configure-backup: This system has not registered configure-backup, it is clean",
        "*****",
        "",
        "* RETURN CODE:0",
        "##################################################"
    ]
}

PLAY RECAP *********************************************************************
10.100.16.29               : ok=74   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
10.100.36.15               : ok=85   changed=43   unreachable=0    failed=0    skipped=5    rescued=0    ignored=0   
10.100.36.33               : ok=25   changed=11   unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   

Playbook run took 0 days, 0 hours, 45 minutes, 17 seconds
